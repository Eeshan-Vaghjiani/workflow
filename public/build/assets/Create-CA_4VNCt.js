import{r as n,j as e,a as w,v as C,$ as S}from"./app-Cz-XC9l4.js";import{P as I}from"./placeholder-pattern-BffCuRGV.js";import{A as $}from"./app-layout-DBbC1wJO.js";import{c as T}from"./createLucideIcon-CfQhLZuM.js";import{C as E}from"./circle-check-big-gIZ6yXgA.js";import{C as q}from"./circle-alert-DaK2Z9wZ.js";import"./app-sidebar-layout-BnpPf58W.js";import"./index-MaZke14b.js";import"./index-BUtF6_nR.js";import"./button-Diu-54fO.js";import"./utils-CBfrqCZ4.js";import"./input-gyYvXWbp.js";import"./dropdown-menu-CMVoGVyb.js";import"./index-B_RcF4Vj.js";import"./index-BlXtbhPC.js";import"./index-BtsonFn7.js";import"./avatar-DLZPR9xF.js";import"./index-CmyQNJFQ.js";import"./use-animation-CJs_orTr.js";import"./use-animation-CBeboh00.js";import"./proxy-DUnCzY_P.js";import"./chevron-right-BnGLYIXb.js";import"./users-Da4X3jqK.js";import"./square-check-big-Dvy61Sch.js";import"./calendar-Cz-eKFtz.js";import"./credit-card-CsbvY-q-.js";import"./user-ILuj1RD-.js";import"./use-appearance-rE9bUEXS.js";import"./sun-C2hnd78D.js";import"./settings-DpzlEckF.js";import"./glass-container-qPlEyThK.js";import"./index-B0-ktvjH.js";/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const P=[["path",{d:"M10 7.5 8 10l2 2.5",key:"xb17xw"}],["path",{d:"m14 7.5 2 2.5-2 2.5",key:"5rap1v"}],["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}]],D=T("MessageSquareCode",P);function F({groupId:o,onTasksCreated:r}){const[a,d]=n.useState(""),[u,m]=n.useState(!1),[p,x]=n.useState(null),[g,b]=n.useState(!0),[s,l]=n.useState(null),[h,f]=n.useState(null),[j,y]=n.useState(null),[v,N]=n.useState(null);n.useEffect(()=>{(async()=>{try{(await w.post("/api/test-ai-tasks",{prompt:"Test prompt"})).data?.success&&l("AI Service is available (no auth mode)")}catch(t){console.error("AI service check failed:",t),l("AI Service might not be available - check OpenRouter API key")}})()},[]);async function A(c){if(c.preventDefault(),!!a.trim()){m(!0),x(null),l(null),f(null),y(null),N(null);try{console.log("Sending request to AI endpoint with groupId:",o);const t=await w.post("/api/no-auth/ai/tasks",{prompt:a,group_id:o},{headers:{"Content-Type":"application/json",Accept:"application/json"}});console.log("AI response received:",t.data);const i=t.data;if(!i.success)throw new Error(i.error||"Unknown error in AI processing");m(!1),d(""),f(`Successfully created assignment "${i.assignment.title}" with ${i.tasks.length} tasks`),y(i.assignment),r&&r({assignment:i.assignment,tasks:i.tasks})}catch(t){m(!1),console.error("Error details:",t);let i="Unknown error occurred";if(t.response){N(t.response.data);const k=t.response.data?.error||t.response.data?.message||`Server error: ${t.response.status} - ${t.response.statusText||"Unknown"}`;if(i=k,t.response.data?.debug)l(JSON.stringify(t.response.data.debug));else if(t.response.data?.trace){const _=Array.isArray(t.response.data.trace)?t.response.data.trace.slice(0,3).join(`
`):t.response.data.trace;l(`${k}
Trace: ${_}`)}else l(`Status: ${t.response.status}
Response data: ${JSON.stringify(t.response.data||{})}`)}else t.request?(i="No response received from server",l("Request was sent but no response was received. Server might be down.")):i=t.message||"Request setup error";x(`Error: ${i}`)}}}return e.jsxs("div",{className:"bg-white dark:bg-neutral-800/70 border border-neutral-200 dark:border-neutral-700 rounded-xl p-4 mb-6",children:[e.jsxs("div",{className:"flex items-center gap-2 cursor-pointer",onClick:()=>b(c=>!c),children:[e.jsx(D,{className:"w-5 h-5 text-blue-500"}),e.jsx("h3",{className:"font-semibold",children:g?"Hide AI Task Creator":"Use AI to Create Tasks"})]}),g&&e.jsxs("div",{className:"mt-4",children:[e.jsxs("div",{className:"p-3 mb-4 bg-blue-100 dark:bg-blue-900/30 text-blue-800 dark:text-blue-200 rounded-md text-sm",children:[e.jsx("p",{className:"font-medium",children:"No login required! This uses the public AI endpoint."}),e.jsx("p",{className:"mt-1",children:"Describe your tasks and the AI will structure them for you."}),s&&e.jsx("p",{className:"mt-1 text-xs font-mono",children:s})]}),h&&e.jsxs("div",{className:"p-3 mb-4 bg-green-100 dark:bg-green-900/30 text-green-800 dark:text-green-200 rounded-md text-sm flex gap-2",children:[e.jsx(E,{className:"w-5 h-5 flex-shrink-0"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:h}),j&&e.jsx("p",{className:"mt-1 text-sm",children:e.jsx("a",{href:`/groups/${o}/assignments/${j.id}`,className:"text-blue-600 dark:text-blue-400 underline",children:"View Assignment"})})]})]}),e.jsx("p",{className:"mb-4 text-sm text-gray-600 dark:text-gray-400",children:"Describe your assignment and tasks in natural language. The AI will help create structured tasks automatically."}),e.jsxs("form",{onSubmit:A,children:[e.jsx("div",{className:"mb-4",children:e.jsx("textarea",{value:a,onChange:c=>d(c.target.value),className:"w-full px-3 py-2 border rounded-md shadow-sm focus:ring focus:ring-opacity-50 border-gray-300 focus:ring-blue-200 focus:border-blue-500 dark:bg-neutral-900 dark:border-neutral-700 dark:text-white",rows:4,placeholder:"Example: Create a website development project for our client XYZ Company. The project needs UI design by Alice due next Friday, backend development by Bob with high priority due in 2 weeks, and deployment by Charlie with medium priority due by the end of the month.",required:!0})}),p&&e.jsxs("div",{className:"mb-4 p-3 bg-red-100 dark:bg-red-900/30 text-red-700 dark:text-red-300 rounded-md text-sm flex gap-2 items-start",children:[e.jsx(q,{className:"w-5 h-5 mt-0.5 flex-shrink-0"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:p}),e.jsxs("p",{className:"mt-2 text-xs",children:["Try visiting ",e.jsx("a",{href:"/ai-test",className:"underline",children:"AI Test Page"})," to check if the OpenRouter API is working."]}),v&&e.jsxs("details",{className:"mt-2",children:[e.jsx("summary",{className:"cursor-pointer text-xs font-medium",children:"Show detailed error information"}),e.jsx("pre",{className:"mt-2 p-2 bg-red-50 dark:bg-red-900/50 rounded text-xs overflow-auto max-h-60",children:JSON.stringify(v,null,2)})]})]})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{className:"text-sm text-gray-500",children:["Group ID: ",o]}),e.jsx("button",{type:"submit",disabled:u,className:"inline-flex items-center px-4 py-2 bg-blue-600 border border-transparent rounded-md font-semibold text-xs text-white uppercase tracking-widest hover:bg-blue-700 disabled:opacity-50",children:u?"Processing...":"Generate Tasks with AI"})]})]})]})]})}const M=[{title:"Assignments",href:"/group-assignments"},{title:"Create",href:"/group-assignments/create"}];function be({groups:o,errors:r}){const{data:a,setData:d,post:u,processing:m}=C({title:"",description:"",due_date:"",group_id:"",unit_name:"General"}),[p,x]=n.useState(!1);function g(s){s.preventDefault(),a.group_id?u(route("group-assignments.store",{group:a.group_id})):alert("Please select a group before creating the assignment.")}const b=s=>{s.assignment?.id&&s.assignment?.group_id&&(x(!0),window.location.href=route("group-assignments.show",{group:s.assignment.group_id,assignment:s.assignment.id}))};return e.jsxs($,{breadcrumbs:M,children:[e.jsx(S,{title:"Create Assignment"}),e.jsxs("div",{className:"flex h-full flex-1 flex-col gap-4 rounded-xl p-4",children:[e.jsxs("div",{className:"mb-4",children:[e.jsx("h1",{className:"text-2xl font-bold",children:"Create Assignment"}),e.jsx("p",{className:"text-gray-500",children:"Create a new assignment for your group"})]}),o.length>0?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"bg-white dark:bg-neutral-800 p-6 rounded-xl border border-neutral-200 dark:border-neutral-700 mb-4",children:e.jsxs("div",{className:"mb-6",children:[e.jsx("label",{htmlFor:"group_id",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"First, select a group"}),e.jsxs("select",{id:"group_id",className:`w-full px-3 py-2 border rounded-md shadow-sm focus:ring focus:ring-opacity-50 ${r.group_id?"border-red-500 focus:ring-red-200":"border-gray-300 focus:ring-blue-200 focus:border-blue-500"}`,value:a.group_id,onChange:s=>d("group_id",s.target.value),required:!0,children:[e.jsx("option",{value:"",children:"Select a group"}),o.map(s=>e.jsx("option",{value:s.id,children:s.name},s.id))]}),r.group_id&&e.jsx("div",{className:"text-red-500 text-sm mt-1",children:r.group_id})]})}),a.group_id&&e.jsx(F,{groupId:a.group_id,onTasksCreated:b}),e.jsxs("div",{className:"bg-white dark:bg-neutral-800 p-6 rounded-xl border border-neutral-200 dark:border-neutral-700",children:[e.jsx("h3",{className:"text-lg font-medium mb-4",children:"Or create an assignment manually"}),e.jsxs("form",{onSubmit:g,children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("label",{htmlFor:"title",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Assignment Title"}),e.jsx("input",{type:"text",id:"title",className:`w-full px-3 py-2 border rounded-md shadow-sm focus:ring focus:ring-opacity-50 ${r.title?"border-red-500 focus:ring-red-200":"border-gray-300 focus:ring-blue-200 focus:border-blue-500"}`,value:a.title,onChange:s=>d("title",s.target.value),required:!0}),r.title&&e.jsx("div",{className:"text-red-500 text-sm mt-1",children:r.title})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("label",{htmlFor:"unit_name",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Unit Name"}),e.jsx("input",{type:"text",id:"unit_name",className:`w-full px-3 py-2 border rounded-md shadow-sm focus:ring focus:ring-opacity-50 ${r.unit_name?"border-red-500 focus:ring-red-200":"border-gray-300 focus:ring-blue-200 focus:border-blue-500"}`,value:a.unit_name,onChange:s=>d("unit_name",s.target.value)}),r.unit_name&&e.jsx("div",{className:"text-red-500 text-sm mt-1",children:r.unit_name})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("label",{htmlFor:"description",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Description"}),e.jsx("textarea",{id:"description",rows:4,className:`w-full px-3 py-2 border rounded-md shadow-sm focus:ring focus:ring-opacity-50 ${r.description?"border-red-500 focus:ring-red-200":"border-gray-300 focus:ring-blue-200 focus:border-blue-500"}`,value:a.description,onChange:s=>d("description",s.target.value)}),r.description&&e.jsx("div",{className:"text-red-500 text-sm mt-1",children:r.description})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("label",{htmlFor:"due_date",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Due Date"}),e.jsx("input",{type:"date",id:"due_date",className:`w-full px-3 py-2 border rounded-md shadow-sm focus:ring focus:ring-opacity-50 ${r.due_date?"border-red-500 focus:ring-red-200":"border-gray-300 focus:ring-blue-200 focus:border-blue-500"}`,value:a.due_date,onChange:s=>d("due_date",s.target.value),required:!0}),r.due_date&&e.jsx("div",{className:"text-red-500 text-sm mt-1",children:r.due_date})]}),e.jsxs("div",{className:"flex justify-end",children:[e.jsx("a",{href:a.group_id?route("group-assignments.index",{group:a.group_id}):"/group-assignments",className:"inline-flex items-center px-4 py-2 mr-3 border border-gray-300 rounded-md font-semibold text-xs text-gray-700 uppercase tracking-widest shadow-sm hover:bg-gray-50",children:"Cancel"}),e.jsx("button",{type:"submit",disabled:m||p,className:"inline-flex items-center px-4 py-2 bg-blue-600 border border-transparent rounded-md font-semibold text-xs text-white uppercase tracking-widest hover:bg-blue-700 disabled:opacity-50",children:"Create Assignment"})]})]})]})]}):e.jsxs("div",{className:"border-sidebar-border/70 dark:border-sidebar-border relative min-h-[50vh] flex items-center justify-center overflow-hidden rounded-xl border",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("h3",{className:"text-xl font-semibold mb-2",children:"No Groups Available"}),e.jsx("p",{className:"text-gray-500 mb-4",children:"You need to be a leader in at least one group to create assignments."}),e.jsx("a",{href:route("groups.create"),className:"inline-flex items-center px-4 py-2 bg-blue-600 border border-transparent rounded-md font-semibold text-xs text-white uppercase tracking-widest hover:bg-blue-700 transition",children:"Create a Group"})]}),e.jsx(I,{className:"absolute inset-0 size-full stroke-neutral-900/10 dark:stroke-neutral-100/10"})]})]})]})}export{be as default};
