import{r as i,R as I,j as s,a as O,$ as Wn}from"./app-Cz-XC9l4.js";import{A as Hn}from"./app-layout-DBbC1wJO.js";import{r as Re}from"./index-BUtF6_nR.js";import{A as fn,a as hn,b as gn}from"./avatar-DLZPR9xF.js";import{B as $}from"./button-Diu-54fO.js";import{B as Vn}from"./badge-DxpFCqhw.js";import{c as pn}from"./utils-CBfrqCZ4.js";import{S as Jn}from"./square-pen-Dr4lgTIH.js";import{c as vt}from"./createLucideIcon-CfQhLZuM.js";import{U as Gn}from"./user-ILuj1RD-.js";import{C as Qn}from"./circle-alert-DaK2Z9wZ.js";import{C as Zn}from"./clock-DzskyGux.js";import{f as ht}from"./format-C2sziSDG.js";import{P as Oe}from"./plus-ax70JYGI.js";import{u as mn}from"./use-toast-LY2u_GWA.js";import{D as bt,a as xt,b as yt,c as wt,d as vn,e as Ct,f as er}from"./dialog-DfYwz7rS.js";import{L as Q}from"./label-TRCAcQVD.js";import{I as We}from"./input-gyYvXWbp.js";import{T as bn}from"./textarea-_X4jAbSH.js";import{S as Yt,a as qt,b as Wt,c as Ht,d as we}from"./select-BCpkfbKh.js";import{P as tr,a as nr,b as rr}from"./popover-tRTs676i.js";import{C as sr}from"./calendar-CpjqwzxS.js";import{C as ar}from"./calendar-Cz-eKFtz.js";import{T as or}from"./trash-2-DglzZvlY.js";import{A as Vt,a as Jt,b as Gt}from"./alert-C0ieycFd.js";import{T as Qt}from"./triangle-alert-DdVqfjlP.js";import{L as ir}from"./app-sidebar-layout-BnpPf58W.js";import"./index-B0-ktvjH.js";import"./proxy-DUnCzY_P.js";import"./index-MaZke14b.js";import"./index-BlXtbhPC.js";import"./index-CmyQNJFQ.js";import"./en-US-CT0ADQGI.js";import"./transition-DECp-BFe.js";import"./with-selector-Bs5_a5KJ.js";import"./x-J8IMCWLS.js";import"./index-BdQq_4o_.js";import"./index-B_RcF4Vj.js";import"./index-BtsonFn7.js";import"./index-D6AxyfCr.js";import"./chevron-down-C-4IPUEA.js";import"./check-DpDReKzm.js";import"./chevron-up-BkkBLiNV.js";import"./setYear-Dg_Q6WC1.js";import"./endOfMonth-D0QkFyMS.js";import"./chevron-right-BnGLYIXb.js";import"./dropdown-menu-CMVoGVyb.js";import"./use-animation-CJs_orTr.js";import"./use-animation-CBeboh00.js";import"./users-Da4X3jqK.js";import"./square-check-big-Dvy61Sch.js";import"./credit-card-CsbvY-q-.js";import"./use-appearance-rE9bUEXS.js";import"./sun-C2hnd78D.js";import"./settings-DpzlEckF.js";import"./glass-container-qPlEyThK.js";/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lr=[["path",{d:"M4 15s1-1 4-1 5 2 8 2 4-1 4-1V3s-1 1-4 1-5-2-8-2-4 1-4 1z",key:"i9b6wo"}],["line",{x1:"4",x2:"4",y1:"22",y2:"15",key:"1cm3nv"}]],cr=vt("Flag",lr);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dr=[["path",{d:"M21 12a9 9 0 0 0-9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"14sxne"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}],["path",{d:"M3 12a9 9 0 0 0 9 9 9.75 9.75 0 0 0 6.74-2.74L21 16",key:"1hlbsb"}],["path",{d:"M16 16h5v5",key:"ccwih5"}]],ur=vt("RefreshCcw",dr);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fr=[["path",{d:"M12.586 2.586A2 2 0 0 0 11.172 2H4a2 2 0 0 0-2 2v7.172a2 2 0 0 0 .586 1.414l8.704 8.704a2.426 2.426 0 0 0 3.42 0l6.58-6.58a2.426 2.426 0 0 0 0-3.42z",key:"vktsd0"}],["circle",{cx:"7.5",cy:"7.5",r:".5",fill:"currentColor",key:"kqv944"}]],hr=vt("Tag",fr),et=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";function je(e){const t=Object.prototype.toString.call(e);return t==="[object Window]"||t==="[object global]"}function jt(e){return"nodeType"in e}function U(e){var t,n;return e?je(e)?e:jt(e)&&(t=(n=e.ownerDocument)==null?void 0:n.defaultView)!=null?t:window:window}function St(e){const{Document:t}=U(e);return e instanceof t}function Pe(e){return je(e)?!1:e instanceof U(e).HTMLElement}function xn(e){return e instanceof U(e).SVGElement}function Se(e){return e?je(e)?e.document:jt(e)?St(e)?e:Pe(e)||xn(e)?e.ownerDocument:document:document:document}const ae=et?i.useLayoutEffect:i.useEffect;function tt(e){const t=i.useRef(e);return ae(()=>{t.current=e}),i.useCallback(function(){for(var n=arguments.length,r=new Array(n),a=0;a<n;a++)r[a]=arguments[a];return t.current==null?void 0:t.current(...r)},[])}function gr(){const e=i.useRef(null),t=i.useCallback((r,a)=>{e.current=setInterval(r,a)},[]),n=i.useCallback(()=>{e.current!==null&&(clearInterval(e.current),e.current=null)},[]);return[t,n]}function Be(e,t){t===void 0&&(t=[e]);const n=i.useRef(e);return ae(()=>{n.current!==e&&(n.current=e)},t),n}function Fe(e,t){const n=i.useRef();return i.useMemo(()=>{const r=e(n.current);return n.current=r,r},[...t])}function He(e){const t=tt(e),n=i.useRef(null),r=i.useCallback(a=>{a!==n.current&&t?.(a,n.current),n.current=a},[]);return[n,r]}function Ve(e){const t=i.useRef();return i.useEffect(()=>{t.current=e},[e]),t.current}let ct={};function nt(e,t){return i.useMemo(()=>{if(t)return t;const n=ct[e]==null?0:ct[e]+1;return ct[e]=n,e+"-"+n},[e,t])}function yn(e){return function(t){for(var n=arguments.length,r=new Array(n>1?n-1:0),a=1;a<n;a++)r[a-1]=arguments[a];return r.reduce((o,l)=>{const c=Object.entries(l);for(const[d,u]of c){const h=o[d];h!=null&&(o[d]=h+e*u)}return o},{...t})}}const Ce=yn(1),Je=yn(-1);function pr(e){return"clientX"in e&&"clientY"in e}function Dt(e){if(!e)return!1;const{KeyboardEvent:t}=U(e.target);return t&&e instanceof t}function mr(e){if(!e)return!1;const{TouchEvent:t}=U(e.target);return t&&e instanceof t}function Ge(e){if(mr(e)){if(e.touches&&e.touches.length){const{clientX:t,clientY:n}=e.touches[0];return{x:t,y:n}}else if(e.changedTouches&&e.changedTouches.length){const{clientX:t,clientY:n}=e.changedTouches[0];return{x:t,y:n}}}return pr(e)?{x:e.clientX,y:e.clientY}:null}const Le=Object.freeze({Translate:{toString(e){if(!e)return;const{x:t,y:n}=e;return"translate3d("+(t?Math.round(t):0)+"px, "+(n?Math.round(n):0)+"px, 0)"}},Scale:{toString(e){if(!e)return;const{scaleX:t,scaleY:n}=e;return"scaleX("+t+") scaleY("+n+")"}},Transform:{toString(e){if(e)return[Le.Translate.toString(e),Le.Scale.toString(e)].join(" ")}},Transition:{toString(e){let{property:t,duration:n,easing:r}=e;return t+" "+n+"ms "+r}}}),Zt="a,frame,iframe,input:not([type=hidden]):not(:disabled),select:not(:disabled),textarea:not(:disabled),button:not(:disabled),*[tabindex]";function vr(e){return e.matches(Zt)?e:e.querySelector(Zt)}const br={display:"none"};function xr(e){let{id:t,value:n}=e;return I.createElement("div",{id:t,style:br},n)}function yr(e){let{id:t,announcement:n,ariaLiveType:r="assertive"}=e;const a={position:"fixed",top:0,left:0,width:1,height:1,margin:-1,border:0,padding:0,overflow:"hidden",clip:"rect(0 0 0 0)",clipPath:"inset(100%)",whiteSpace:"nowrap"};return I.createElement("div",{id:t,style:a,role:"status","aria-live":r,"aria-atomic":!0},n)}function wr(){const[e,t]=i.useState("");return{announce:i.useCallback(r=>{r!=null&&t(r)},[]),announcement:e}}const wn=i.createContext(null);function Cr(e){const t=i.useContext(wn);i.useEffect(()=>{if(!t)throw new Error("useDndMonitor must be used within a children of <DndContext>");return t(e)},[e,t])}function jr(){const[e]=i.useState(()=>new Set),t=i.useCallback(r=>(e.add(r),()=>e.delete(r)),[e]);return[i.useCallback(r=>{let{type:a,event:o}=r;e.forEach(l=>{var c;return(c=l[a])==null?void 0:c.call(l,o)})},[e]),t]}const Sr={draggable:`
    To pick up a draggable item, press the space bar.
    While dragging, use the arrow keys to move the item.
    Press space again to drop the item in its new position, or press escape to cancel.
  `},Dr={onDragStart(e){let{active:t}=e;return"Picked up draggable item "+t.id+"."},onDragOver(e){let{active:t,over:n}=e;return n?"Draggable item "+t.id+" was moved over droppable area "+n.id+".":"Draggable item "+t.id+" is no longer over a droppable area."},onDragEnd(e){let{active:t,over:n}=e;return n?"Draggable item "+t.id+" was dropped over droppable area "+n.id:"Draggable item "+t.id+" was dropped."},onDragCancel(e){let{active:t}=e;return"Dragging was cancelled. Draggable item "+t.id+" was dropped."}};function Nr(e){let{announcements:t=Dr,container:n,hiddenTextDescribedById:r,screenReaderInstructions:a=Sr}=e;const{announce:o,announcement:l}=wr(),c=nt("DndLiveRegion"),[d,u]=i.useState(!1);if(i.useEffect(()=>{u(!0)},[]),Cr(i.useMemo(()=>({onDragStart(f){let{active:v}=f;o(t.onDragStart({active:v}))},onDragMove(f){let{active:v,over:g}=f;t.onDragMove&&o(t.onDragMove({active:v,over:g}))},onDragOver(f){let{active:v,over:g}=f;o(t.onDragOver({active:v,over:g}))},onDragEnd(f){let{active:v,over:g}=f;o(t.onDragEnd({active:v,over:g}))},onDragCancel(f){let{active:v,over:g}=f;o(t.onDragCancel({active:v,over:g}))}}),[o,t])),!d)return null;const h=I.createElement(I.Fragment,null,I.createElement(xr,{id:r,value:a.draggable}),I.createElement(yr,{id:c,announcement:l}));return n?Re.createPortal(h,n):h}var F;(function(e){e.DragStart="dragStart",e.DragMove="dragMove",e.DragEnd="dragEnd",e.DragCancel="dragCancel",e.DragOver="dragOver",e.RegisterDroppable="registerDroppable",e.SetDroppableDisabled="setDroppableDisabled",e.UnregisterDroppable="unregisterDroppable"})(F||(F={}));function Qe(){}function Er(e,t){return i.useMemo(()=>({sensor:e,options:t??{}}),[e,t])}function kr(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return i.useMemo(()=>[...t].filter(r=>r!=null),[...t])}const ee=Object.freeze({x:0,y:0});function Rr(e,t){const n=Ge(e);if(!n)return"0 0";const r={x:(n.x-t.left)/t.width*100,y:(n.y-t.top)/t.height*100};return r.x+"% "+r.y+"%"}function Tr(e,t){let{data:{value:n}}=e,{data:{value:r}}=t;return r-n}function Ar(e,t){if(!e||e.length===0)return null;const[n]=e;return n[t]}function Mr(e,t){const n=Math.max(t.top,e.top),r=Math.max(t.left,e.left),a=Math.min(t.left+t.width,e.left+e.width),o=Math.min(t.top+t.height,e.top+e.height),l=a-r,c=o-n;if(r<a&&n<o){const d=t.width*t.height,u=e.width*e.height,h=l*c,f=h/(d+u-h);return Number(f.toFixed(4))}return 0}const Or=e=>{let{collisionRect:t,droppableRects:n,droppableContainers:r}=e;const a=[];for(const o of r){const{id:l}=o,c=n.get(l);if(c){const d=Mr(c,t);d>0&&a.push({id:l,data:{droppableContainer:o,value:d}})}}return a.sort(Tr)};function Br(e,t,n){return{...e,scaleX:t&&n?t.width/n.width:1,scaleY:t&&n?t.height/n.height:1}}function Cn(e,t){return e&&t?{x:e.left-t.left,y:e.top-t.top}:ee}function Lr(e){return function(n){for(var r=arguments.length,a=new Array(r>1?r-1:0),o=1;o<r;o++)a[o-1]=arguments[o];return a.reduce((l,c)=>({...l,top:l.top+e*c.y,bottom:l.bottom+e*c.y,left:l.left+e*c.x,right:l.right+e*c.x}),{...n})}}const Ir=Lr(1);function jn(e){if(e.startsWith("matrix3d(")){const t=e.slice(9,-1).split(/, /);return{x:+t[12],y:+t[13],scaleX:+t[0],scaleY:+t[5]}}else if(e.startsWith("matrix(")){const t=e.slice(7,-1).split(/, /);return{x:+t[4],y:+t[5],scaleX:+t[0],scaleY:+t[3]}}return null}function Pr(e,t,n){const r=jn(t);if(!r)return e;const{scaleX:a,scaleY:o,x:l,y:c}=r,d=e.left-l-(1-a)*parseFloat(n),u=e.top-c-(1-o)*parseFloat(n.slice(n.indexOf(" ")+1)),h=a?e.width/a:e.width,f=o?e.height/o:e.height;return{width:h,height:f,top:u,right:d+h,bottom:u+f,left:d}}const Fr={ignoreTransform:!1};function ze(e,t){t===void 0&&(t=Fr);let n=e.getBoundingClientRect();if(t.ignoreTransform){const{transform:u,transformOrigin:h}=U(e).getComputedStyle(e);u&&(n=Pr(n,u,h))}const{top:r,left:a,width:o,height:l,bottom:c,right:d}=n;return{top:r,left:a,width:o,height:l,bottom:c,right:d}}function en(e){return ze(e,{ignoreTransform:!0})}function zr(e){const t=e.innerWidth,n=e.innerHeight;return{top:0,left:0,right:t,bottom:n,width:t,height:n}}function Kr(e,t){return t===void 0&&(t=U(e).getComputedStyle(e)),t.position==="fixed"}function $r(e,t){t===void 0&&(t=U(e).getComputedStyle(e));const n=/(auto|scroll|overlay)/;return["overflow","overflowX","overflowY"].some(a=>{const o=t[a];return typeof o=="string"?n.test(o):!1})}function Nt(e,t){const n=[];function r(a){if(t!=null&&n.length>=t||!a)return n;if(St(a)&&a.scrollingElement!=null&&!n.includes(a.scrollingElement))return n.push(a.scrollingElement),n;if(!Pe(a)||xn(a)||n.includes(a))return n;const o=U(e).getComputedStyle(a);return a!==e&&$r(a,o)&&n.push(a),Kr(a,o)?n:r(a.parentNode)}return e?r(e):n}function Sn(e){const[t]=Nt(e,1);return t??null}function dt(e){return!et||!e?null:je(e)?e:jt(e)?St(e)||e===Se(e).scrollingElement?window:Pe(e)?e:null:null}function Dn(e){return je(e)?e.scrollX:e.scrollLeft}function Nn(e){return je(e)?e.scrollY:e.scrollTop}function gt(e){return{x:Dn(e),y:Nn(e)}}var z;(function(e){e[e.Forward=1]="Forward",e[e.Backward=-1]="Backward"})(z||(z={}));function En(e){return!et||!e?!1:e===document.scrollingElement}function kn(e){const t={x:0,y:0},n=En(e)?{height:window.innerHeight,width:window.innerWidth}:{height:e.clientHeight,width:e.clientWidth},r={x:e.scrollWidth-n.width,y:e.scrollHeight-n.height},a=e.scrollTop<=t.y,o=e.scrollLeft<=t.x,l=e.scrollTop>=r.y,c=e.scrollLeft>=r.x;return{isTop:a,isLeft:o,isBottom:l,isRight:c,maxScroll:r,minScroll:t}}const _r={x:.2,y:.2};function Ur(e,t,n,r,a){let{top:o,left:l,right:c,bottom:d}=n;r===void 0&&(r=10),a===void 0&&(a=_r);const{isTop:u,isBottom:h,isLeft:f,isRight:v}=kn(e),g={x:0,y:0},S={x:0,y:0},m={height:t.height*a.y,width:t.width*a.x};return!u&&o<=t.top+m.height?(g.y=z.Backward,S.y=r*Math.abs((t.top+m.height-o)/m.height)):!h&&d>=t.bottom-m.height&&(g.y=z.Forward,S.y=r*Math.abs((t.bottom-m.height-d)/m.height)),!v&&c>=t.right-m.width?(g.x=z.Forward,S.x=r*Math.abs((t.right-m.width-c)/m.width)):!f&&l<=t.left+m.width&&(g.x=z.Backward,S.x=r*Math.abs((t.left+m.width-l)/m.width)),{direction:g,speed:S}}function Xr(e){if(e===document.scrollingElement){const{innerWidth:o,innerHeight:l}=window;return{top:0,left:0,right:o,bottom:l,width:o,height:l}}const{top:t,left:n,right:r,bottom:a}=e.getBoundingClientRect();return{top:t,left:n,right:r,bottom:a,width:e.clientWidth,height:e.clientHeight}}function Rn(e){return e.reduce((t,n)=>Ce(t,gt(n)),ee)}function Yr(e){return e.reduce((t,n)=>t+Dn(n),0)}function qr(e){return e.reduce((t,n)=>t+Nn(n),0)}function Tn(e,t){if(t===void 0&&(t=ze),!e)return;const{top:n,left:r,bottom:a,right:o}=t(e);Sn(e)&&(a<=0||o<=0||n>=window.innerHeight||r>=window.innerWidth)&&e.scrollIntoView({block:"center",inline:"center"})}const Wr=[["x",["left","right"],Yr],["y",["top","bottom"],qr]];class Et{constructor(t,n){this.rect=void 0,this.width=void 0,this.height=void 0,this.top=void 0,this.bottom=void 0,this.right=void 0,this.left=void 0;const r=Nt(n),a=Rn(r);this.rect={...t},this.width=t.width,this.height=t.height;for(const[o,l,c]of Wr)for(const d of l)Object.defineProperty(this,d,{get:()=>{const u=c(r),h=a[o]-u;return this.rect[d]+h},enumerable:!0});Object.defineProperty(this,"rect",{enumerable:!1})}}class Te{constructor(t){this.target=void 0,this.listeners=[],this.removeAll=()=>{this.listeners.forEach(n=>{var r;return(r=this.target)==null?void 0:r.removeEventListener(...n)})},this.target=t}add(t,n,r){var a;(a=this.target)==null||a.addEventListener(t,n,r),this.listeners.push([t,n,r])}}function Hr(e){const{EventTarget:t}=U(e);return e instanceof t?e:Se(e)}function ut(e,t){const n=Math.abs(e.x),r=Math.abs(e.y);return typeof t=="number"?Math.sqrt(n**2+r**2)>t:"x"in t&&"y"in t?n>t.x&&r>t.y:"x"in t?n>t.x:"y"in t?r>t.y:!1}var V;(function(e){e.Click="click",e.DragStart="dragstart",e.Keydown="keydown",e.ContextMenu="contextmenu",e.Resize="resize",e.SelectionChange="selectionchange",e.VisibilityChange="visibilitychange"})(V||(V={}));function tn(e){e.preventDefault()}function Vr(e){e.stopPropagation()}var A;(function(e){e.Space="Space",e.Down="ArrowDown",e.Right="ArrowRight",e.Left="ArrowLeft",e.Up="ArrowUp",e.Esc="Escape",e.Enter="Enter",e.Tab="Tab"})(A||(A={}));const An={start:[A.Space,A.Enter],cancel:[A.Esc],end:[A.Space,A.Enter,A.Tab]},Jr=(e,t)=>{let{currentCoordinates:n}=t;switch(e.code){case A.Right:return{...n,x:n.x+25};case A.Left:return{...n,x:n.x-25};case A.Down:return{...n,y:n.y+25};case A.Up:return{...n,y:n.y-25}}};class Mn{constructor(t){this.props=void 0,this.autoScrollEnabled=!1,this.referenceCoordinates=void 0,this.listeners=void 0,this.windowListeners=void 0,this.props=t;const{event:{target:n}}=t;this.props=t,this.listeners=new Te(Se(n)),this.windowListeners=new Te(U(n)),this.handleKeyDown=this.handleKeyDown.bind(this),this.handleCancel=this.handleCancel.bind(this),this.attach()}attach(){this.handleStart(),this.windowListeners.add(V.Resize,this.handleCancel),this.windowListeners.add(V.VisibilityChange,this.handleCancel),setTimeout(()=>this.listeners.add(V.Keydown,this.handleKeyDown))}handleStart(){const{activeNode:t,onStart:n}=this.props,r=t.node.current;r&&Tn(r),n(ee)}handleKeyDown(t){if(Dt(t)){const{active:n,context:r,options:a}=this.props,{keyboardCodes:o=An,coordinateGetter:l=Jr,scrollBehavior:c="smooth"}=a,{code:d}=t;if(o.end.includes(d)){this.handleEnd(t);return}if(o.cancel.includes(d)){this.handleCancel(t);return}const{collisionRect:u}=r.current,h=u?{x:u.left,y:u.top}:ee;this.referenceCoordinates||(this.referenceCoordinates=h);const f=l(t,{active:n,context:r.current,currentCoordinates:h});if(f){const v=Je(f,h),g={x:0,y:0},{scrollableAncestors:S}=r.current;for(const m of S){const b=t.code,{isTop:w,isRight:D,isLeft:j,isBottom:M,maxScroll:E,minScroll:R}=kn(m),p=Xr(m),x={x:Math.min(b===A.Right?p.right-p.width/2:p.right,Math.max(b===A.Right?p.left:p.left+p.width/2,f.x)),y:Math.min(b===A.Down?p.bottom-p.height/2:p.bottom,Math.max(b===A.Down?p.top:p.top+p.height/2,f.y))},T=b===A.Right&&!D||b===A.Left&&!j,L=b===A.Down&&!M||b===A.Up&&!w;if(T&&x.x!==f.x){const C=m.scrollLeft+v.x,N=b===A.Right&&C<=E.x||b===A.Left&&C>=R.x;if(N&&!v.y){m.scrollTo({left:C,behavior:c});return}N?g.x=m.scrollLeft-C:g.x=b===A.Right?m.scrollLeft-E.x:m.scrollLeft-R.x,g.x&&m.scrollBy({left:-g.x,behavior:c});break}else if(L&&x.y!==f.y){const C=m.scrollTop+v.y,N=b===A.Down&&C<=E.y||b===A.Up&&C>=R.y;if(N&&!v.x){m.scrollTo({top:C,behavior:c});return}N?g.y=m.scrollTop-C:g.y=b===A.Down?m.scrollTop-E.y:m.scrollTop-R.y,g.y&&m.scrollBy({top:-g.y,behavior:c});break}}this.handleMove(t,Ce(Je(f,this.referenceCoordinates),g))}}}handleMove(t,n){const{onMove:r}=this.props;t.preventDefault(),r(n)}handleEnd(t){const{onEnd:n}=this.props;t.preventDefault(),this.detach(),n()}handleCancel(t){const{onCancel:n}=this.props;t.preventDefault(),this.detach(),n()}detach(){this.listeners.removeAll(),this.windowListeners.removeAll()}}Mn.activators=[{eventName:"onKeyDown",handler:(e,t,n)=>{let{keyboardCodes:r=An,onActivation:a}=t,{active:o}=n;const{code:l}=e.nativeEvent;if(r.start.includes(l)){const c=o.activatorNode.current;return c&&e.target!==c?!1:(e.preventDefault(),a?.({event:e.nativeEvent}),!0)}return!1}}];function nn(e){return!!(e&&"distance"in e)}function rn(e){return!!(e&&"delay"in e)}class kt{constructor(t,n,r){var a;r===void 0&&(r=Hr(t.event.target)),this.props=void 0,this.events=void 0,this.autoScrollEnabled=!0,this.document=void 0,this.activated=!1,this.initialCoordinates=void 0,this.timeoutId=null,this.listeners=void 0,this.documentListeners=void 0,this.windowListeners=void 0,this.props=t,this.events=n;const{event:o}=t,{target:l}=o;this.props=t,this.events=n,this.document=Se(l),this.documentListeners=new Te(this.document),this.listeners=new Te(r),this.windowListeners=new Te(U(l)),this.initialCoordinates=(a=Ge(o))!=null?a:ee,this.handleStart=this.handleStart.bind(this),this.handleMove=this.handleMove.bind(this),this.handleEnd=this.handleEnd.bind(this),this.handleCancel=this.handleCancel.bind(this),this.handleKeydown=this.handleKeydown.bind(this),this.removeTextSelection=this.removeTextSelection.bind(this),this.attach()}attach(){const{events:t,props:{options:{activationConstraint:n,bypassActivationConstraint:r}}}=this;if(this.listeners.add(t.move.name,this.handleMove,{passive:!1}),this.listeners.add(t.end.name,this.handleEnd),t.cancel&&this.listeners.add(t.cancel.name,this.handleCancel),this.windowListeners.add(V.Resize,this.handleCancel),this.windowListeners.add(V.DragStart,tn),this.windowListeners.add(V.VisibilityChange,this.handleCancel),this.windowListeners.add(V.ContextMenu,tn),this.documentListeners.add(V.Keydown,this.handleKeydown),n){if(r!=null&&r({event:this.props.event,activeNode:this.props.activeNode,options:this.props.options}))return this.handleStart();if(rn(n)){this.timeoutId=setTimeout(this.handleStart,n.delay),this.handlePending(n);return}if(nn(n)){this.handlePending(n);return}}this.handleStart()}detach(){this.listeners.removeAll(),this.windowListeners.removeAll(),setTimeout(this.documentListeners.removeAll,50),this.timeoutId!==null&&(clearTimeout(this.timeoutId),this.timeoutId=null)}handlePending(t,n){const{active:r,onPending:a}=this.props;a(r,t,this.initialCoordinates,n)}handleStart(){const{initialCoordinates:t}=this,{onStart:n}=this.props;t&&(this.activated=!0,this.documentListeners.add(V.Click,Vr,{capture:!0}),this.removeTextSelection(),this.documentListeners.add(V.SelectionChange,this.removeTextSelection),n(t))}handleMove(t){var n;const{activated:r,initialCoordinates:a,props:o}=this,{onMove:l,options:{activationConstraint:c}}=o;if(!a)return;const d=(n=Ge(t))!=null?n:ee,u=Je(a,d);if(!r&&c){if(nn(c)){if(c.tolerance!=null&&ut(u,c.tolerance))return this.handleCancel();if(ut(u,c.distance))return this.handleStart()}if(rn(c)&&ut(u,c.tolerance))return this.handleCancel();this.handlePending(c,u);return}t.cancelable&&t.preventDefault(),l(d)}handleEnd(){const{onAbort:t,onEnd:n}=this.props;this.detach(),this.activated||t(this.props.active),n()}handleCancel(){const{onAbort:t,onCancel:n}=this.props;this.detach(),this.activated||t(this.props.active),n()}handleKeydown(t){t.code===A.Esc&&this.handleCancel()}removeTextSelection(){var t;(t=this.document.getSelection())==null||t.removeAllRanges()}}const Gr={cancel:{name:"pointercancel"},move:{name:"pointermove"},end:{name:"pointerup"}};class Rt extends kt{constructor(t){const{event:n}=t,r=Se(n.target);super(t,Gr,r)}}Rt.activators=[{eventName:"onPointerDown",handler:(e,t)=>{let{nativeEvent:n}=e,{onActivation:r}=t;return!n.isPrimary||n.button!==0?!1:(r?.({event:n}),!0)}}];const Qr={move:{name:"mousemove"},end:{name:"mouseup"}};var pt;(function(e){e[e.RightClick=2]="RightClick"})(pt||(pt={}));class Zr extends kt{constructor(t){super(t,Qr,Se(t.event.target))}}Zr.activators=[{eventName:"onMouseDown",handler:(e,t)=>{let{nativeEvent:n}=e,{onActivation:r}=t;return n.button===pt.RightClick?!1:(r?.({event:n}),!0)}}];const ft={cancel:{name:"touchcancel"},move:{name:"touchmove"},end:{name:"touchend"}};class es extends kt{constructor(t){super(t,ft)}static setup(){return window.addEventListener(ft.move.name,t,{capture:!1,passive:!1}),function(){window.removeEventListener(ft.move.name,t)};function t(){}}}es.activators=[{eventName:"onTouchStart",handler:(e,t)=>{let{nativeEvent:n}=e,{onActivation:r}=t;const{touches:a}=n;return a.length>1?!1:(r?.({event:n}),!0)}}];var Ae;(function(e){e[e.Pointer=0]="Pointer",e[e.DraggableRect=1]="DraggableRect"})(Ae||(Ae={}));var Ze;(function(e){e[e.TreeOrder=0]="TreeOrder",e[e.ReversedTreeOrder=1]="ReversedTreeOrder"})(Ze||(Ze={}));function ts(e){let{acceleration:t,activator:n=Ae.Pointer,canScroll:r,draggingRect:a,enabled:o,interval:l=5,order:c=Ze.TreeOrder,pointerCoordinates:d,scrollableAncestors:u,scrollableAncestorRects:h,delta:f,threshold:v}=e;const g=rs({delta:f,disabled:!o}),[S,m]=gr(),b=i.useRef({x:0,y:0}),w=i.useRef({x:0,y:0}),D=i.useMemo(()=>{switch(n){case Ae.Pointer:return d?{top:d.y,bottom:d.y,left:d.x,right:d.x}:null;case Ae.DraggableRect:return a}},[n,a,d]),j=i.useRef(null),M=i.useCallback(()=>{const R=j.current;if(!R)return;const p=b.current.x*w.current.x,x=b.current.y*w.current.y;R.scrollBy(p,x)},[]),E=i.useMemo(()=>c===Ze.TreeOrder?[...u].reverse():u,[c,u]);i.useEffect(()=>{if(!o||!u.length||!D){m();return}for(const R of E){if(r?.(R)===!1)continue;const p=u.indexOf(R),x=h[p];if(!x)continue;const{direction:T,speed:L}=Ur(R,x,D,t,v);for(const C of["x","y"])g[C][T[C]]||(L[C]=0,T[C]=0);if(L.x>0||L.y>0){m(),j.current=R,S(M,l),b.current=L,w.current=T;return}}b.current={x:0,y:0},w.current={x:0,y:0},m()},[t,M,r,m,o,l,JSON.stringify(D),JSON.stringify(g),S,u,E,h,JSON.stringify(v)])}const ns={x:{[z.Backward]:!1,[z.Forward]:!1},y:{[z.Backward]:!1,[z.Forward]:!1}};function rs(e){let{delta:t,disabled:n}=e;const r=Ve(t);return Fe(a=>{if(n||!r||!a)return ns;const o={x:Math.sign(t.x-r.x),y:Math.sign(t.y-r.y)};return{x:{[z.Backward]:a.x[z.Backward]||o.x===-1,[z.Forward]:a.x[z.Forward]||o.x===1},y:{[z.Backward]:a.y[z.Backward]||o.y===-1,[z.Forward]:a.y[z.Forward]||o.y===1}}},[n,t,r])}function ss(e,t){const n=t!=null?e.get(t):void 0,r=n?n.node.current:null;return Fe(a=>{var o;return t==null?null:(o=r??a)!=null?o:null},[r,t])}function as(e,t){return i.useMemo(()=>e.reduce((n,r)=>{const{sensor:a}=r,o=a.activators.map(l=>({eventName:l.eventName,handler:t(l.handler,r)}));return[...n,...o]},[]),[e,t])}var Ie;(function(e){e[e.Always=0]="Always",e[e.BeforeDragging=1]="BeforeDragging",e[e.WhileDragging=2]="WhileDragging"})(Ie||(Ie={}));var mt;(function(e){e.Optimized="optimized"})(mt||(mt={}));const sn=new Map;function os(e,t){let{dragging:n,dependencies:r,config:a}=t;const[o,l]=i.useState(null),{frequency:c,measure:d,strategy:u}=a,h=i.useRef(e),f=b(),v=Be(f),g=i.useCallback(function(w){w===void 0&&(w=[]),!v.current&&l(D=>D===null?w:D.concat(w.filter(j=>!D.includes(j))))},[v]),S=i.useRef(null),m=Fe(w=>{if(f&&!n)return sn;if(!w||w===sn||h.current!==e||o!=null){const D=new Map;for(let j of e){if(!j)continue;if(o&&o.length>0&&!o.includes(j.id)&&j.rect.current){D.set(j.id,j.rect.current);continue}const M=j.node.current,E=M?new Et(d(M),M):null;j.rect.current=E,E&&D.set(j.id,E)}return D}return w},[e,o,n,f,d]);return i.useEffect(()=>{h.current=e},[e]),i.useEffect(()=>{f||g()},[n,f]),i.useEffect(()=>{o&&o.length>0&&l(null)},[JSON.stringify(o)]),i.useEffect(()=>{f||typeof c!="number"||S.current!==null||(S.current=setTimeout(()=>{g(),S.current=null},c))},[c,f,g,...r]),{droppableRects:m,measureDroppableContainers:g,measuringScheduled:o!=null};function b(){switch(u){case Ie.Always:return!1;case Ie.BeforeDragging:return n;default:return!n}}}function Tt(e,t){return Fe(n=>e?n||(typeof t=="function"?t(e):e):null,[t,e])}function is(e,t){return Tt(e,t)}function ls(e){let{callback:t,disabled:n}=e;const r=tt(t),a=i.useMemo(()=>{if(n||typeof window>"u"||typeof window.MutationObserver>"u")return;const{MutationObserver:o}=window;return new o(r)},[r,n]);return i.useEffect(()=>()=>a?.disconnect(),[a]),a}function rt(e){let{callback:t,disabled:n}=e;const r=tt(t),a=i.useMemo(()=>{if(n||typeof window>"u"||typeof window.ResizeObserver>"u")return;const{ResizeObserver:o}=window;return new o(r)},[n]);return i.useEffect(()=>()=>a?.disconnect(),[a]),a}function cs(e){return new Et(ze(e),e)}function an(e,t,n){t===void 0&&(t=cs);const[r,a]=i.useState(null);function o(){a(d=>{if(!e)return null;if(e.isConnected===!1){var u;return(u=d??n)!=null?u:null}const h=t(e);return JSON.stringify(d)===JSON.stringify(h)?d:h})}const l=ls({callback(d){if(e)for(const u of d){const{type:h,target:f}=u;if(h==="childList"&&f instanceof HTMLElement&&f.contains(e)){o();break}}}}),c=rt({callback:o});return ae(()=>{o(),e?(c?.observe(e),l?.observe(document.body,{childList:!0,subtree:!0})):(c?.disconnect(),l?.disconnect())},[e]),r}function ds(e){const t=Tt(e);return Cn(e,t)}const on=[];function us(e){const t=i.useRef(e),n=Fe(r=>e?r&&r!==on&&e&&t.current&&e.parentNode===t.current.parentNode?r:Nt(e):on,[e]);return i.useEffect(()=>{t.current=e},[e]),n}function fs(e){const[t,n]=i.useState(null),r=i.useRef(e),a=i.useCallback(o=>{const l=dt(o.target);l&&n(c=>c?(c.set(l,gt(l)),new Map(c)):null)},[]);return i.useEffect(()=>{const o=r.current;if(e!==o){l(o);const c=e.map(d=>{const u=dt(d);return u?(u.addEventListener("scroll",a,{passive:!0}),[u,gt(u)]):null}).filter(d=>d!=null);n(c.length?new Map(c):null),r.current=e}return()=>{l(e),l(o)};function l(c){c.forEach(d=>{const u=dt(d);u?.removeEventListener("scroll",a)})}},[a,e]),i.useMemo(()=>e.length?t?Array.from(t.values()).reduce((o,l)=>Ce(o,l),ee):Rn(e):ee,[e,t])}function ln(e,t){t===void 0&&(t=[]);const n=i.useRef(null);return i.useEffect(()=>{n.current=null},t),i.useEffect(()=>{const r=e!==ee;r&&!n.current&&(n.current=e),!r&&n.current&&(n.current=null)},[e]),n.current?Je(e,n.current):ee}function hs(e){i.useEffect(()=>{if(!et)return;const t=e.map(n=>{let{sensor:r}=n;return r.setup==null?void 0:r.setup()});return()=>{for(const n of t)n?.()}},e.map(t=>{let{sensor:n}=t;return n}))}function gs(e,t){return i.useMemo(()=>e.reduce((n,r)=>{let{eventName:a,handler:o}=r;return n[a]=l=>{o(l,t)},n},{}),[e,t])}function On(e){return i.useMemo(()=>e?zr(e):null,[e])}const cn=[];function ps(e,t){t===void 0&&(t=ze);const[n]=e,r=On(n?U(n):null),[a,o]=i.useState(cn);function l(){o(()=>e.length?e.map(d=>En(d)?r:new Et(t(d),d)):cn)}const c=rt({callback:l});return ae(()=>{c?.disconnect(),l(),e.forEach(d=>c?.observe(d))},[e]),a}function Bn(e){if(!e)return null;if(e.children.length>1)return e;const t=e.children[0];return Pe(t)?t:e}function ms(e){let{measure:t}=e;const[n,r]=i.useState(null),a=i.useCallback(u=>{for(const{target:h}of u)if(Pe(h)){r(f=>{const v=t(h);return f?{...f,width:v.width,height:v.height}:v});break}},[t]),o=rt({callback:a}),l=i.useCallback(u=>{const h=Bn(u);o?.disconnect(),h&&o?.observe(h),r(h?t(h):null)},[t,o]),[c,d]=He(l);return i.useMemo(()=>({nodeRef:c,rect:n,setRef:d}),[n,c,d])}const vs=[{sensor:Rt,options:{}},{sensor:Mn,options:{}}],bs={current:{}},qe={draggable:{measure:en},droppable:{measure:en,strategy:Ie.WhileDragging,frequency:mt.Optimized},dragOverlay:{measure:ze}};class Me extends Map{get(t){var n;return t!=null&&(n=super.get(t))!=null?n:void 0}toArray(){return Array.from(this.values())}getEnabled(){return this.toArray().filter(t=>{let{disabled:n}=t;return!n})}getNodeFor(t){var n,r;return(n=(r=this.get(t))==null?void 0:r.node.current)!=null?n:void 0}}const xs={activatorEvent:null,active:null,activeNode:null,activeNodeRect:null,collisions:null,containerNodeRect:null,draggableNodes:new Map,droppableRects:new Map,droppableContainers:new Me,over:null,dragOverlay:{nodeRef:{current:null},rect:null,setRef:Qe},scrollableAncestors:[],scrollableAncestorRects:[],measuringConfiguration:qe,measureDroppableContainers:Qe,windowRect:null,measuringScheduled:!1},Ln={activatorEvent:null,activators:[],active:null,activeNodeRect:null,ariaDescribedById:{draggable:""},dispatch:Qe,draggableNodes:new Map,over:null,measureDroppableContainers:Qe},Ke=i.createContext(Ln),In=i.createContext(xs);function ys(){return{draggable:{active:null,initialCoordinates:{x:0,y:0},nodes:new Map,translate:{x:0,y:0}},droppable:{containers:new Me}}}function ws(e,t){switch(t.type){case F.DragStart:return{...e,draggable:{...e.draggable,initialCoordinates:t.initialCoordinates,active:t.active}};case F.DragMove:return e.draggable.active==null?e:{...e,draggable:{...e.draggable,translate:{x:t.coordinates.x-e.draggable.initialCoordinates.x,y:t.coordinates.y-e.draggable.initialCoordinates.y}}};case F.DragEnd:case F.DragCancel:return{...e,draggable:{...e.draggable,active:null,initialCoordinates:{x:0,y:0},translate:{x:0,y:0}}};case F.RegisterDroppable:{const{element:n}=t,{id:r}=n,a=new Me(e.droppable.containers);return a.set(r,n),{...e,droppable:{...e.droppable,containers:a}}}case F.SetDroppableDisabled:{const{id:n,key:r,disabled:a}=t,o=e.droppable.containers.get(n);if(!o||r!==o.key)return e;const l=new Me(e.droppable.containers);return l.set(n,{...o,disabled:a}),{...e,droppable:{...e.droppable,containers:l}}}case F.UnregisterDroppable:{const{id:n,key:r}=t,a=e.droppable.containers.get(n);if(!a||r!==a.key)return e;const o=new Me(e.droppable.containers);return o.delete(n),{...e,droppable:{...e.droppable,containers:o}}}default:return e}}function Cs(e){let{disabled:t}=e;const{active:n,activatorEvent:r,draggableNodes:a}=i.useContext(Ke),o=Ve(r),l=Ve(n?.id);return i.useEffect(()=>{if(!t&&!r&&o&&l!=null){if(!Dt(o)||document.activeElement===o.target)return;const c=a.get(l);if(!c)return;const{activatorNode:d,node:u}=c;if(!d.current&&!u.current)return;requestAnimationFrame(()=>{for(const h of[d.current,u.current]){if(!h)continue;const f=vr(h);if(f){f.focus();break}}})}},[r,t,a,l,o]),null}function Pn(e,t){let{transform:n,...r}=t;return e!=null&&e.length?e.reduce((a,o)=>o({transform:a,...r}),n):n}function js(e){return i.useMemo(()=>({draggable:{...qe.draggable,...e?.draggable},droppable:{...qe.droppable,...e?.droppable},dragOverlay:{...qe.dragOverlay,...e?.dragOverlay}}),[e?.draggable,e?.droppable,e?.dragOverlay])}function Ss(e){let{activeNode:t,measure:n,initialRect:r,config:a=!0}=e;const o=i.useRef(!1),{x:l,y:c}=typeof a=="boolean"?{x:a,y:a}:a;ae(()=>{if(!l&&!c||!t){o.current=!1;return}if(o.current||!r)return;const u=t?.node.current;if(!u||u.isConnected===!1)return;const h=n(u),f=Cn(h,r);if(l||(f.x=0),c||(f.y=0),o.current=!0,Math.abs(f.x)>0||Math.abs(f.y)>0){const v=Sn(u);v&&v.scrollBy({top:f.y,left:f.x})}},[t,l,c,r,n])}const st=i.createContext({...ee,scaleX:1,scaleY:1});var ue;(function(e){e[e.Uninitialized=0]="Uninitialized",e[e.Initializing=1]="Initializing",e[e.Initialized=2]="Initialized"})(ue||(ue={}));const Ds=i.memo(function(t){var n,r,a,o;let{id:l,accessibility:c,autoScroll:d=!0,children:u,sensors:h=vs,collisionDetection:f=Or,measuring:v,modifiers:g,...S}=t;const m=i.useReducer(ws,void 0,ys),[b,w]=m,[D,j]=jr(),[M,E]=i.useState(ue.Uninitialized),R=M===ue.Initialized,{draggable:{active:p,nodes:x,translate:T},droppable:{containers:L}}=b,C=p!=null?x.get(p):null,N=i.useRef({initial:null,translated:null}),k=i.useMemo(()=>{var _;return p!=null?{id:p,data:(_=C?.data)!=null?_:bs,rect:N}:null},[p,C]),y=i.useRef(null),[B,te]=i.useState(null),[X,$e]=i.useState(null),P=Be(S,Object.values(S)),fe=nt("DndDescribedBy",l),At=i.useMemo(()=>L.getEnabled(),[L]),he=js(v),{droppableRects:me,measureDroppableContainers:_e,measuringScheduled:Mt}=os(At,{dragging:R,dependencies:[T.x,T.y],config:he.droppable}),J=ss(x,p),Ot=i.useMemo(()=>X?Ge(X):null,[X]),Bt=qn(),Lt=is(J,he.draggable.measure);Ss({activeNode:p!=null?x.get(p):null,config:Bt.layoutShiftCompensation,initialRect:Lt,measure:he.draggable.measure});const G=an(J,he.draggable.measure,Lt),at=an(J?J.parentElement:null),ge=i.useRef({activatorEvent:null,active:null,activeNode:J,collisionRect:null,collisions:null,droppableRects:me,draggableNodes:x,draggingNode:null,draggingNodeRect:null,droppableContainers:L,over:null,scrollableAncestors:[],scrollAdjustedTranslate:null}),It=L.getNodeFor((n=ge.current.over)==null?void 0:n.id),pe=ms({measure:he.dragOverlay.measure}),Ue=(r=pe.nodeRef.current)!=null?r:J,ve=R?(a=pe.rect)!=null?a:G:null,Pt=!!(pe.nodeRef.current&&pe.rect),Ft=ds(Pt?null:G),ot=On(Ue?U(Ue):null),oe=us(R?It??J:null),Xe=ps(oe),Ye=Pn(g,{transform:{x:T.x-Ft.x,y:T.y-Ft.y,scaleX:1,scaleY:1},activatorEvent:X,active:k,activeNodeRect:G,containerNodeRect:at,draggingNodeRect:ve,over:ge.current.over,overlayNodeRect:pe.rect,scrollableAncestors:oe,scrollableAncestorRects:Xe,windowRect:ot}),zt=Ot?Ce(Ot,T):null,Kt=fs(oe),zn=ln(Kt),Kn=ln(Kt,[G]),be=Ce(Ye,zn),xe=ve?Ir(ve,Ye):null,De=k&&xe?f({active:k,collisionRect:xe,droppableRects:me,droppableContainers:At,pointerCoordinates:zt}):null,$t=Ar(De,"id"),[ie,_t]=i.useState(null),$n=Pt?Ye:Ce(Ye,Kn),_n=Br($n,(o=ie?.rect)!=null?o:null,G),it=i.useRef(null),Ut=i.useCallback((_,Y)=>{let{sensor:q,options:le}=Y;if(y.current==null)return;const H=x.get(y.current);if(!H)return;const W=_.nativeEvent,ne=new q({active:y.current,activeNode:H,event:W,options:le,context:ge,onAbort(K){if(!x.get(K))return;const{onDragAbort:re}=P.current,se={id:K};re?.(se),D({type:"onDragAbort",event:se})},onPending(K,ce,re,se){if(!x.get(K))return;const{onDragPending:Ee}=P.current,de={id:K,constraint:ce,initialCoordinates:re,offset:se};Ee?.(de),D({type:"onDragPending",event:de})},onStart(K){const ce=y.current;if(ce==null)return;const re=x.get(ce);if(!re)return;const{onDragStart:se}=P.current,Ne={activatorEvent:W,active:{id:ce,data:re.data,rect:N}};Re.unstable_batchedUpdates(()=>{se?.(Ne),E(ue.Initializing),w({type:F.DragStart,initialCoordinates:K,active:ce}),D({type:"onDragStart",event:Ne}),te(it.current),$e(W)})},onMove(K){w({type:F.DragMove,coordinates:K})},onEnd:ye(F.DragEnd),onCancel:ye(F.DragCancel)});it.current=ne;function ye(K){return async function(){const{active:re,collisions:se,over:Ne,scrollAdjustedTranslate:Ee}=ge.current;let de=null;if(re&&Ee){const{cancelDrop:ke}=P.current;de={activatorEvent:W,active:re,collisions:se,delta:Ee,over:Ne},K===F.DragEnd&&typeof ke=="function"&&await Promise.resolve(ke(de))&&(K=F.DragCancel)}y.current=null,Re.unstable_batchedUpdates(()=>{w({type:K}),E(ue.Uninitialized),_t(null),te(null),$e(null),it.current=null;const ke=K===F.DragEnd?"onDragEnd":"onDragCancel";if(de){const lt=P.current[ke];lt?.(de),D({type:ke,event:de})}})}}},[x]),Un=i.useCallback((_,Y)=>(q,le)=>{const H=q.nativeEvent,W=x.get(le);if(y.current!==null||!W||H.dndKit||H.defaultPrevented)return;const ne={active:W};_(q,Y.options,ne)===!0&&(H.dndKit={capturedBy:Y.sensor},y.current=le,Ut(q,Y))},[x,Ut]),Xt=as(h,Un);hs(h),ae(()=>{G&&M===ue.Initializing&&E(ue.Initialized)},[G,M]),i.useEffect(()=>{const{onDragMove:_}=P.current,{active:Y,activatorEvent:q,collisions:le,over:H}=ge.current;if(!Y||!q)return;const W={active:Y,activatorEvent:q,collisions:le,delta:{x:be.x,y:be.y},over:H};Re.unstable_batchedUpdates(()=>{_?.(W),D({type:"onDragMove",event:W})})},[be.x,be.y]),i.useEffect(()=>{const{active:_,activatorEvent:Y,collisions:q,droppableContainers:le,scrollAdjustedTranslate:H}=ge.current;if(!_||y.current==null||!Y||!H)return;const{onDragOver:W}=P.current,ne=le.get($t),ye=ne&&ne.rect.current?{id:ne.id,rect:ne.rect.current,data:ne.data,disabled:ne.disabled}:null,K={active:_,activatorEvent:Y,collisions:q,delta:{x:H.x,y:H.y},over:ye};Re.unstable_batchedUpdates(()=>{_t(ye),W?.(K),D({type:"onDragOver",event:K})})},[$t]),ae(()=>{ge.current={activatorEvent:X,active:k,activeNode:J,collisionRect:xe,collisions:De,droppableRects:me,draggableNodes:x,draggingNode:Ue,draggingNodeRect:ve,droppableContainers:L,over:ie,scrollableAncestors:oe,scrollAdjustedTranslate:be},N.current={initial:ve,translated:xe}},[k,J,De,xe,x,Ue,ve,me,L,ie,oe,be]),ts({...Bt,delta:T,draggingRect:xe,pointerCoordinates:zt,scrollableAncestors:oe,scrollableAncestorRects:Xe});const Xn=i.useMemo(()=>({active:k,activeNode:J,activeNodeRect:G,activatorEvent:X,collisions:De,containerNodeRect:at,dragOverlay:pe,draggableNodes:x,droppableContainers:L,droppableRects:me,over:ie,measureDroppableContainers:_e,scrollableAncestors:oe,scrollableAncestorRects:Xe,measuringConfiguration:he,measuringScheduled:Mt,windowRect:ot}),[k,J,G,X,De,at,pe,x,L,me,ie,_e,oe,Xe,he,Mt,ot]),Yn=i.useMemo(()=>({activatorEvent:X,activators:Xt,active:k,activeNodeRect:G,ariaDescribedById:{draggable:fe},dispatch:w,draggableNodes:x,over:ie,measureDroppableContainers:_e}),[X,Xt,k,G,w,fe,x,ie,_e]);return I.createElement(wn.Provider,{value:j},I.createElement(Ke.Provider,{value:Yn},I.createElement(In.Provider,{value:Xn},I.createElement(st.Provider,{value:_n},u)),I.createElement(Cs,{disabled:c?.restoreFocus===!1})),I.createElement(Nr,{...c,hiddenTextDescribedById:fe}));function qn(){const _=B?.autoScrollEnabled===!1,Y=typeof d=="object"?d.enabled===!1:d===!1,q=R&&!_&&!Y;return typeof d=="object"?{...d,enabled:q}:{enabled:q}}}),Ns=i.createContext(null),dn="button",Es="Draggable";function ks(e){let{id:t,data:n,disabled:r=!1,attributes:a}=e;const o=nt(Es),{activators:l,activatorEvent:c,active:d,activeNodeRect:u,ariaDescribedById:h,draggableNodes:f,over:v}=i.useContext(Ke),{role:g=dn,roleDescription:S="draggable",tabIndex:m=0}=a??{},b=d?.id===t,w=i.useContext(b?st:Ns),[D,j]=He(),[M,E]=He(),R=gs(l,t),p=Be(n);ae(()=>(f.set(t,{id:t,key:o,node:D,activatorNode:M,data:p}),()=>{const T=f.get(t);T&&T.key===o&&f.delete(t)}),[f,t]);const x=i.useMemo(()=>({role:g,tabIndex:m,"aria-disabled":r,"aria-pressed":b&&g===dn?!0:void 0,"aria-roledescription":S,"aria-describedby":h.draggable}),[r,g,m,b,S,h.draggable]);return{active:d,activatorEvent:c,activeNodeRect:u,attributes:x,isDragging:b,listeners:r?void 0:R,node:D,over:v,setNodeRef:j,setActivatorNodeRef:E,transform:w}}function Rs(){return i.useContext(In)}const Ts="Droppable",As={timeout:25};function Ms(e){let{data:t,disabled:n=!1,id:r,resizeObserverConfig:a}=e;const o=nt(Ts),{active:l,dispatch:c,over:d,measureDroppableContainers:u}=i.useContext(Ke),h=i.useRef({disabled:n}),f=i.useRef(!1),v=i.useRef(null),g=i.useRef(null),{disabled:S,updateMeasurementsFor:m,timeout:b}={...As,...a},w=Be(m??r),D=i.useCallback(()=>{if(!f.current){f.current=!0;return}g.current!=null&&clearTimeout(g.current),g.current=setTimeout(()=>{u(Array.isArray(w.current)?w.current:[w.current]),g.current=null},b)},[b]),j=rt({callback:D,disabled:S||!l}),M=i.useCallback((x,T)=>{j&&(T&&(j.unobserve(T),f.current=!1),x&&j.observe(x))},[j]),[E,R]=He(M),p=Be(t);return i.useEffect(()=>{!j||!E.current||(j.disconnect(),f.current=!1,j.observe(E.current))},[E,j]),i.useEffect(()=>(c({type:F.RegisterDroppable,element:{id:r,key:o,disabled:n,node:E,rect:v,data:p}}),()=>c({type:F.UnregisterDroppable,key:o,id:r})),[r]),i.useEffect(()=>{n!==h.current.disabled&&(c({type:F.SetDroppableDisabled,id:r,key:o,disabled:n}),h.current.disabled=n)},[r,o,n,c]),{active:l,rect:v,isOver:d?.id===r,node:E,over:d,setNodeRef:R}}function Os(e){let{animation:t,children:n}=e;const[r,a]=i.useState(null),[o,l]=i.useState(null),c=Ve(n);return!n&&!r&&c&&a(c),ae(()=>{if(!o)return;const d=r?.key,u=r?.props.id;if(d==null||u==null){a(null);return}Promise.resolve(t(u,o)).then(()=>{a(null)})},[t,r,o]),I.createElement(I.Fragment,null,n,r?i.cloneElement(r,{ref:l}):null)}const Bs={x:0,y:0,scaleX:1,scaleY:1};function Ls(e){let{children:t}=e;return I.createElement(Ke.Provider,{value:Ln},I.createElement(st.Provider,{value:Bs},t))}const Is={position:"fixed",touchAction:"none"},Ps=e=>Dt(e)?"transform 250ms ease":void 0,Fs=i.forwardRef((e,t)=>{let{as:n,activatorEvent:r,adjustScale:a,children:o,className:l,rect:c,style:d,transform:u,transition:h=Ps}=e;if(!c)return null;const f=a?u:{...u,scaleX:1,scaleY:1},v={...Is,width:c.width,height:c.height,top:c.top,left:c.left,transform:Le.Transform.toString(f),transformOrigin:a&&r?Rr(r,c):void 0,transition:typeof h=="function"?h(r):h,...d};return I.createElement(n,{className:l,style:v,ref:t},o)}),zs=e=>t=>{let{active:n,dragOverlay:r}=t;const a={},{styles:o,className:l}=e;if(o!=null&&o.active)for(const[c,d]of Object.entries(o.active))d!==void 0&&(a[c]=n.node.style.getPropertyValue(c),n.node.style.setProperty(c,d));if(o!=null&&o.dragOverlay)for(const[c,d]of Object.entries(o.dragOverlay))d!==void 0&&r.node.style.setProperty(c,d);return l!=null&&l.active&&n.node.classList.add(l.active),l!=null&&l.dragOverlay&&r.node.classList.add(l.dragOverlay),function(){for(const[d,u]of Object.entries(a))n.node.style.setProperty(d,u);l!=null&&l.active&&n.node.classList.remove(l.active)}},Ks=e=>{let{transform:{initial:t,final:n}}=e;return[{transform:Le.Transform.toString(t)},{transform:Le.Transform.toString(n)}]},$s={duration:250,easing:"ease",keyframes:Ks,sideEffects:zs({styles:{active:{opacity:"0"}}})};function _s(e){let{config:t,draggableNodes:n,droppableContainers:r,measuringConfiguration:a}=e;return tt((o,l)=>{if(t===null)return;const c=n.get(o);if(!c)return;const d=c.node.current;if(!d)return;const u=Bn(l);if(!u)return;const{transform:h}=U(l).getComputedStyle(l),f=jn(h);if(!f)return;const v=typeof t=="function"?t:Us(t);return Tn(d,a.draggable.measure),v({active:{id:o,data:c.data,node:d,rect:a.draggable.measure(d)},draggableNodes:n,dragOverlay:{node:l,rect:a.dragOverlay.measure(u)},droppableContainers:r,measuringConfiguration:a,transform:f})})}function Us(e){const{duration:t,easing:n,sideEffects:r,keyframes:a}={...$s,...e};return o=>{let{active:l,dragOverlay:c,transform:d,...u}=o;if(!t)return;const h={x:c.rect.left-l.rect.left,y:c.rect.top-l.rect.top},f={scaleX:d.scaleX!==1?l.rect.width*d.scaleX/c.rect.width:1,scaleY:d.scaleY!==1?l.rect.height*d.scaleY/c.rect.height:1},v={x:d.x-h.x,y:d.y-h.y,...f},g=a({...u,active:l,dragOverlay:c,transform:{initial:d,final:v}}),[S]=g,m=g[g.length-1];if(JSON.stringify(S)===JSON.stringify(m))return;const b=r?.({active:l,dragOverlay:c,...u}),w=c.node.animate(g,{duration:t,easing:n,fill:"forwards"});return new Promise(D=>{w.onfinish=()=>{b?.(),D()}})}}let un=0;function Xs(e){return i.useMemo(()=>{if(e!=null)return un++,un},[e])}const Ys=I.memo(e=>{let{adjustScale:t=!1,children:n,dropAnimation:r,style:a,transition:o,modifiers:l,wrapperElement:c="div",className:d,zIndex:u=999}=e;const{activatorEvent:h,active:f,activeNodeRect:v,containerNodeRect:g,draggableNodes:S,droppableContainers:m,dragOverlay:b,over:w,measuringConfiguration:D,scrollableAncestors:j,scrollableAncestorRects:M,windowRect:E}=Rs(),R=i.useContext(st),p=Xs(f?.id),x=Pn(l,{activatorEvent:h,active:f,activeNodeRect:v,containerNodeRect:g,draggingNodeRect:b.rect,over:w,overlayNodeRect:b.rect,scrollableAncestors:j,scrollableAncestorRects:M,transform:R,windowRect:E}),T=Tt(v),L=_s({config:r,draggableNodes:S,droppableContainers:m,measuringConfiguration:D}),C=T?b.setRef:void 0;return I.createElement(Ls,null,I.createElement(Os,{animation:L},f&&p?I.createElement(Fs,{key:p,id:f.id,ref:C,as:c,activatorEvent:h,adjustScale:t,className:d,transition:o,rect:T,style:{zIndex:u,...a},transform:x},n):null))});function Fn({task:e,onEdit:t,className:n}){const{attributes:r,listeners:a,setNodeRef:o,isDragging:l}=ks({id:e.id.toString(),data:{type:"task",task:e}}),c={low:"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-300",medium:"bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-300",high:"bg-orange-100 text-orange-800 dark:bg-orange-900 dark:text-orange-300",urgent:"bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-300"},d=h=>{if(!h)return null;const f=new Date(h),v=new Date;v.setHours(0,0,0,0);const g=new Date(v);g.setDate(g.getDate()+1);const S=Math.floor((f.getTime()-v.getTime())/(1e3*60*60*24));let m="text-gray-600 dark:text-gray-400";S<0?m="text-red-500 dark:text-red-400 font-medium":S<=1&&(m="text-amber-500 dark:text-amber-400");let b=ht(f,"MMM d");return f.getTime()===v.getTime()?b="Today":f.getTime()===g.getTime()&&(b="Tomorrow"),s.jsxs("div",{className:`flex items-center gap-1 text-xs ${m}`,children:[s.jsx(Zn,{className:"h-3 w-3"}),s.jsx("span",{children:b})]})},u=h=>h.split(" ").map(f=>f[0]).join("").toUpperCase().substring(0,2);return s.jsxs("div",{ref:o,...a,...r,className:pn("flex flex-col p-3 bg-white dark:bg-gray-900 rounded-md border border-gray-200 dark:border-gray-700 shadow-sm","hover:border-gray-300 dark:hover:border-gray-600 cursor-grab","focus:outline-none focus:ring-2 focus:ring-primary focus:ring-opacity-50",l&&"opacity-50",n),children:[s.jsxs("div",{className:"flex justify-between items-start mb-2",children:[s.jsx("h4",{className:"font-medium text-sm text-foreground line-clamp-2",children:e.title}),s.jsx($,{variant:"ghost",size:"sm",onClick:h=>{h.stopPropagation(),t()},className:"h-6 w-6 p-0",children:s.jsx(Jn,{className:"h-3 w-3"})})]}),e.description&&s.jsx("p",{className:"text-xs text-muted-foreground mb-3 line-clamp-3",children:e.description}),s.jsxs("div",{className:"mt-auto pt-2 flex flex-wrap gap-2 text-xs",children:[s.jsxs(Vn,{variant:"outline",className:`px-2 py-1 ${c[e.priority]}`,children:[s.jsx(cr,{className:"h-3 w-3 mr-1"}),e.priority.charAt(0).toUpperCase()+e.priority.slice(1)]}),e.due_date&&d(e.due_date),e.tags&&e.tags.length>0&&s.jsxs("div",{className:"flex items-center gap-1 text-xs text-muted-foreground",children:[s.jsx(hr,{className:"h-3 w-3"}),s.jsxs("span",{children:[e.tags.length," ",e.tags.length===1?"tag":"tags"]})]})]}),s.jsxs("div",{className:"flex justify-between items-center mt-3 pt-3 border-t border-gray-100 dark:border-gray-800",children:[e.assigned_user?s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsxs(fn,{className:"h-5 w-5",children:[s.jsx(hn,{src:e.assigned_user.avatar||"",alt:e.assigned_user.name}),s.jsx(gn,{className:"text-[10px]",children:u(e.assigned_user.name)})]}),s.jsx("span",{className:"text-xs text-muted-foreground",children:e.assigned_user.name})]}):s.jsxs("div",{className:"flex items-center gap-1 text-xs text-muted-foreground",children:[s.jsx(Gn,{className:"h-3 w-3"}),s.jsx("span",{children:"Unassigned"})]}),e.attachments&&e.attachments.length>0&&s.jsxs("div",{className:"flex items-center gap-1 text-xs text-muted-foreground",children:[s.jsx(Qn,{className:"h-3 w-3"}),s.jsx("span",{children:e.attachments.length})]})]})]})}function qs({column:e,onAddTask:t,onEditTask:n}){const{setNodeRef:r,isOver:a}=Ms({id:`column-${e.id}`,data:{type:"column",column:e}}),o=[...e.tasks].sort((l,c)=>l.position-c.position);return s.jsxs("div",{ref:r,className:`flex flex-col w-[350px] flex-shrink-0 rounded-md overflow-hidden bg-gray-50 dark:bg-gray-800 ${a?"ring-2 ring-primary ring-opacity-50":""}`,style:{borderLeft:`4px solid ${e.color}`},children:[s.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-100 dark:bg-gray-800 border-b border-gray-200 dark:border-gray-700",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("h3",{className:"font-medium text-foreground",children:e.name}),s.jsx("span",{className:"flex items-center justify-center h-5 min-w-[20px] rounded-full bg-gray-200 dark:bg-gray-700 text-xs px-1.5",children:o.length})]}),s.jsx($,{onClick:t,variant:"ghost",size:"sm",className:"h-8 w-8 p-0",children:s.jsx(Oe,{className:"h-4 w-4"})})]}),s.jsx("div",{className:"flex-1 p-2 space-y-2 overflow-y-auto max-h-[calc(100vh-250px)]",children:o.length>0?o.map(l=>s.jsx(Fn,{task:l,onEdit:()=>n(l)},l.id)):s.jsx("div",{className:"flex items-center justify-center h-24 border border-dashed border-gray-300 dark:border-gray-600 rounded-md",children:s.jsx("p",{className:"text-sm text-muted-foreground",children:"No tasks"})})})]})}const Z={checkAuth:async()=>{try{return(await O.get("/auth/status")).data}catch{return{authenticated:!1,error:"Authentication check failed"}}},getBoards:async()=>{try{await O.get("/sanctum/csrf-cookie",{withCredentials:!0});const t={"X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]')?.getAttribute("content")||"",Accept:"application/json","Content-Type":"application/json","X-Requested-With":"XMLHttpRequest"},n=await O.get("/api/direct/kanban/boards",{headers:t,withCredentials:!0});return n.data.data||n.data}catch{return[]}},getBoard:async e=>{const t=await O.get(`/api/direct/kanban/boards/${e}`);return t.data.data||t.data},createBoard:async e=>{await O.get("/sanctum/csrf-cookie",{withCredentials:!0});const t=await O.post("/api/direct/kanban/boards",e);return t.data.data||t.data},updateBoard:async(e,t)=>{await O.get("/sanctum/csrf-cookie",{withCredentials:!0});const n=await O.put(`/api/direct/kanban/boards/${e}`,t);return n.data.data||n.data},deleteBoard:async e=>{await O.get("/sanctum/csrf-cookie",{withCredentials:!0}),await O.delete(`/api/direct/kanban/boards/${e}`)},createColumn:async e=>{await O.get("/sanctum/csrf-cookie",{withCredentials:!0});const t=await O.post("/api/direct/kanban/columns",e);return t.data.data||t.data},updateColumn:async(e,t)=>{await O.get("/sanctum/csrf-cookie",{withCredentials:!0});const n=await O.put(`/api/direct/kanban/columns/${e}`,t);return n.data.data||n.data},deleteColumn:async e=>{await O.get("/sanctum/csrf-cookie",{withCredentials:!0}),await O.delete(`/api/direct/kanban/columns/${e}`)},createTask:async e=>{await O.get("/sanctum/csrf-cookie",{withCredentials:!0});const t=await O.post("/api/direct/kanban/tasks",e);return t.data.data||t.data},updateTask:async(e,t)=>{await O.get("/sanctum/csrf-cookie",{withCredentials:!0});const n=await O.put(`/api/direct/kanban/tasks/${e}`,t);return n.data.data||n.data},deleteTask:async e=>{await O.get("/sanctum/csrf-cookie",{withCredentials:!0}),await O.delete(`/api/direct/kanban/tasks/${e}`)},moveTask:async(e,t,n)=>{await O.get("/sanctum/csrf-cookie",{withCredentials:!0});const r=await O.post(`/api/direct/kanban/tasks/${e}/move`,{column_id:t,position:n});return r.data.data||r.data}};function Ws({open:e,onOpenChange:t,onSubmit:n}){const[r,a]=i.useState(""),[o,l]=i.useState("#3B82F6"),c=[{name:"Slate",value:"#64748B"},{name:"Blue",value:"#3B82F6"},{name:"Amber",value:"#F59E0B"},{name:"Violet",value:"#8B5CF6"},{name:"Emerald",value:"#10B981"},{name:"Rose",value:"#F43F5E"},{name:"Indigo",value:"#6366F1"},{name:"Orange",value:"#F97316"}],d=u=>{u.preventDefault(),r.trim()&&(n({name:r.trim(),color:o}),a(""))};return s.jsx(bt,{open:e,onOpenChange:t,children:s.jsx(xt,{className:"sm:max-w-[425px]",children:s.jsxs("form",{onSubmit:d,children:[s.jsxs(yt,{children:[s.jsx(wt,{children:"Add New Column"}),s.jsx(vn,{children:"Create a new column for your Kanban board."})]}),s.jsxs("div",{className:"grid gap-4 py-4",children:[s.jsxs("div",{className:"grid gap-2",children:[s.jsx(Q,{htmlFor:"name",children:"Column Name"}),s.jsx(We,{id:"name",value:r,onChange:u=>a(u.target.value),placeholder:"e.g., To Do, In Progress, Done",required:!0})]}),s.jsxs("div",{className:"grid gap-2",children:[s.jsx(Q,{children:"Column Color"}),s.jsx("div",{className:"flex flex-wrap gap-2",children:c.map(u=>s.jsx("button",{type:"button",className:`w-8 h-8 rounded-full cursor-pointer ${o===u.value?"ring-2 ring-primary ring-offset-2":""}`,style:{backgroundColor:u.value},onClick:()=>l(u.value),title:u.name},u.value))})]})]}),s.jsxs(Ct,{children:[s.jsx(er,{asChild:!0,children:s.jsx($,{type:"button",variant:"outline",children:"Cancel"})}),s.jsx($,{type:"submit",disabled:!r.trim(),children:"Add Column"})]})]})})})}function Hs({open:e,onOpenChange:t,task:n,onSave:r,onDelete:a}){const[o,l]=i.useState(n.title),[c,d]=i.useState(n.description||""),[u,h]=i.useState(n.priority),[f,v]=i.useState(n.assigned_to),[g,S]=i.useState(n.due_date?new Date(n.due_date):void 0),[m,b]=i.useState(n.tags||[]),[w,D]=i.useState(""),[j,M]=i.useState([]),[E,R]=i.useState(!1),[p,x]=i.useState(!1);i.useEffect(()=>{(async()=>{try{const B=await O.get("/api/direct/users");B.data&&Array.isArray(B.data.data||B.data)&&M(B.data.data||B.data)}catch(B){console.error("Error fetching users:",B),M([{id:1,name:"Default User"}])}})()},[]),i.useEffect(()=>{l(n.title),d(n.description||""),h(n.priority),v(n.assigned_to),S(n.due_date?new Date(n.due_date):void 0),b(n.tags||[])},[n]);const T=y=>{y.preventDefault(),R(!0);const B={title:o.trim(),description:c.trim()||void 0,priority:u,assigned_to:f,due_date:g?ht(g,"yyyy-MM-dd"):void 0,tags:m,column_id:n.column_id,position:n.position};r(B),R(!1)},L=()=>{if(!w.trim())return;const y=w.trim();m.includes(y)||b([...m,y]),D("")},C=y=>{b(m.filter(B=>B!==y))},N=()=>{n.id&&confirm("Are you sure you want to delete this task?")&&(x(!0),a(n.id))},k=y=>y.split(" ").map(B=>B[0]).join("").toUpperCase().substring(0,2);return s.jsx(bt,{open:e,onOpenChange:t,children:s.jsx(xt,{className:"sm:max-w-[650px] max-h-[85vh] overflow-y-auto",children:s.jsxs("form",{onSubmit:T,children:[s.jsxs(yt,{children:[s.jsx(wt,{children:n.id?"Edit Task":"Create New Task"}),s.jsx(vn,{children:n.id?"Update task details":"Add a new task to your board"})]}),s.jsxs("div",{className:"grid gap-4 py-4",children:[s.jsxs("div",{className:"grid gap-2",children:[s.jsx(Q,{htmlFor:"title",children:"Title"}),s.jsx(We,{id:"title",value:o,onChange:y=>l(y.target.value),placeholder:"Task title",required:!0})]}),s.jsxs("div",{className:"grid gap-2",children:[s.jsx(Q,{htmlFor:"description",children:"Description"}),s.jsx(bn,{id:"description",value:c,onChange:y=>d(y.target.value),placeholder:"Task description",rows:4})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[s.jsxs("div",{className:"grid gap-2",children:[s.jsx(Q,{htmlFor:"priority",children:"Priority"}),s.jsxs(Yt,{value:u,onValueChange:y=>h(y),children:[s.jsx(qt,{id:"priority",children:s.jsx(Wt,{placeholder:"Select priority"})}),s.jsxs(Ht,{children:[s.jsx(we,{value:"low",children:"Low"}),s.jsx(we,{value:"medium",children:"Medium"}),s.jsx(we,{value:"high",children:"High"}),s.jsx(we,{value:"urgent",children:"Urgent"})]})]})]}),s.jsxs("div",{className:"grid gap-2",children:[s.jsx(Q,{htmlFor:"assignedTo",children:"Assigned To"}),s.jsxs(Yt,{value:f?.toString()||"none",onValueChange:y=>v(y!=="none"?parseInt(y):void 0),children:[s.jsx(qt,{id:"assignedTo",children:s.jsx(Wt,{placeholder:"Select user"})}),s.jsxs(Ht,{children:[s.jsx(we,{value:"none",children:"Unassigned"}),j.map(y=>s.jsx(we,{value:y.id.toString(),children:s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsxs(fn,{className:"h-6 w-6",children:[y.avatar?s.jsx(hn,{src:y.avatar,alt:y.name}):null,s.jsx(gn,{children:k(y.name)})]}),y.name]})},y.id))]})]})]})]}),s.jsxs("div",{className:"grid gap-2",children:[s.jsx(Q,{htmlFor:"dueDate",children:"Due Date"}),s.jsxs(tr,{children:[s.jsx(nr,{asChild:!0,children:s.jsxs($,{id:"dueDate",variant:"outline",className:pn("w-full justify-start text-left font-normal",!g&&"text-muted-foreground"),children:[s.jsx(ar,{className:"mr-2 h-4 w-4"}),g?ht(g,"MMMM d, yyyy"):"No due date"]})}),s.jsx(rr,{className:"w-auto p-0",children:s.jsx(sr,{mode:"single",selected:g,onSelect:S,initialFocus:!0})})]})]}),s.jsxs("div",{className:"grid gap-2",children:[s.jsx(Q,{htmlFor:"tags",children:"Tags"}),s.jsxs("div",{className:"flex gap-2",children:[s.jsx(We,{id:"tags",value:w,onChange:y=>D(y.target.value),placeholder:"Add a tag",className:"flex-1",onKeyDown:y=>{y.key==="Enter"&&(y.preventDefault(),L())}}),s.jsx($,{type:"button",onClick:L,variant:"outline",children:"Add"})]}),m.length>0&&s.jsx("div",{className:"flex flex-wrap gap-2 mt-2",children:m.map(y=>s.jsxs("div",{className:"flex items-center gap-1 bg-secondary px-2 py-1 rounded-md text-sm",children:[s.jsx("span",{children:y}),s.jsx("button",{type:"button",onClick:()=>C(y),className:"text-muted-foreground hover:text-foreground",children:""})]},y))})]})]}),s.jsxs(Ct,{className:"flex justify-between",children:[s.jsx("div",{children:n.id>0&&s.jsxs($,{type:"button",variant:"destructive",onClick:N,disabled:p,className:"flex items-center gap-1",children:[s.jsx(or,{className:"h-4 w-4"}),"Delete"]})}),s.jsxs("div",{className:"flex gap-2",children:[s.jsx($,{type:"button",variant:"outline",onClick:()=>t(!1),children:"Cancel"}),s.jsx($,{type:"submit",disabled:E||!o.trim(),children:E?"Saving...":n.id?"Update":"Create"})]})]})]})})})}function Vs({boardId:e}){const[t,n]=i.useState(null),[r,a]=i.useState([]),[o,l]=i.useState(null),[c,d]=i.useState(!1),[u,h]=i.useState(!1),[f,v]=i.useState(null),[g,S]=i.useState(!0),[m,b]=i.useState(null),{toast:w}=mn(),D=kr(Er(Rt,{activationConstraint:{distance:8}})),j=i.useCallback(async()=>{try{S(!0);const C=await Z.getBoard(e);n(C),a(C.columns||[]),S(!1)}catch(C){console.error("Error fetching board:",C),b("Failed to load board data"),S(!1)}},[e]);i.useEffect(()=>{j()},[j]);const M=async C=>{const{active:N,over:k}=C;if(!k||!r||r.length===0)return;const y=N.id.toString(),B=N.data.current?.task,te=parseInt(k.id.toString().split("-")[1]);if(B.column_id===te)return;const X=r.find(P=>P.id===te);if(!X)return;const $e=r.map(P=>{if(P.id===B.column_id)return{...P,tasks:P.tasks.filter(fe=>fe.id!==B.id)};if(P.id===te){const fe={...B,column_id:te,position:X.tasks.length};return{...P,tasks:[...P.tasks,fe]}}return P});a($e),l(null);try{await Z.moveTask(parseInt(y),te,X.tasks.length)}catch(P){console.error("Error moving task:",P),w({title:"Error moving task",description:"Could not move task to the new column",variant:"destructive"}),j()}},E=C=>{const{active:N}=C,k=N.id.toString();if(r&&r.length>0){for(const y of r)if(y.tasks&&y.tasks.length>0){const B=y.tasks.find(te=>te.id.toString()===k);if(B){l(B);break}}}},R=async C=>{try{const N=await Z.createColumn({...C,board_id:e,position:r?r.length:0});a(k=>[...k||[],{...N,tasks:[]}]),d(!1),w({title:"Column added",description:"New column has been added successfully"})}catch(N){console.error("Error adding column:",N),w({title:"Error adding column",description:"Could not add the new column",variant:"destructive"})}},p=C=>{const N=r.find(k=>k.id===C);N&&(v({id:0,board_id:e,column_id:C,title:"",description:"",priority:"medium",created_by:0,position:N.tasks?N.tasks.length:0,tags:[],attachments:[]}),h(!0))},x=C=>{v(C),h(!0)},T=async C=>{try{if(f?.id){const N=await Z.updateTask(f.id,C);a(r.map(k=>k.id===N.column_id?{...k,tasks:k.tasks.map(y=>y.id===N.id?N:y)}:k)),w({title:"Task updated",description:"Task has been updated successfully"})}else{const N=await Z.createTask({...C,board_id:e});a(r.map(k=>k.id===N.column_id?{...k,tasks:[...k.tasks,N]}:k)),w({title:"Task added",description:"New task has been added successfully"})}h(!1)}catch(N){console.error("Error saving task:",N),w({title:"Error saving task",description:"Could not save the task",variant:"destructive"})}},L=async C=>{try{await Z.deleteTask(C),a(r.map(N=>({...N,tasks:N.tasks.filter(k=>k.id!==C)}))),h(!1),w({title:"Task deleted",description:"Task has been deleted successfully"})}catch(N){console.error("Error deleting task:",N),w({title:"Error deleting task",description:"Could not delete the task",variant:"destructive"})}};return g?s.jsx("div",{className:"flex items-center justify-center h-64",children:s.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-primary"})}):m?s.jsxs("div",{className:"flex flex-col items-center justify-center h-64",children:[s.jsx("p",{className:"text-destructive text-lg mb-4",children:m}),s.jsx($,{onClick:j,children:"Retry"})]}):s.jsxs("div",{className:"flex flex-col h-full",children:[s.jsxs("div",{className:"flex justify-between items-center p-4 border-b border-gray-200 dark:border-gray-700",children:[s.jsxs("div",{children:[s.jsx("h1",{className:"text-2xl font-bold",children:t?.name}),s.jsx("p",{className:"text-muted-foreground",children:t?.description})]}),s.jsxs($,{variant:"outline",onClick:()=>d(!0),className:"flex items-center gap-1",children:[s.jsx(Oe,{size:16}),"Add Column"]})]}),s.jsx("div",{className:"flex-1 overflow-x-auto p-4",children:s.jsxs(Ds,{sensors:D,onDragStart:E,onDragEnd:M,children:[s.jsx("div",{className:"flex gap-4 h-full min-h-[calc(100vh-250px)]",children:r&&r.length>0?r.map(C=>s.jsx(qs,{column:C,onAddTask:()=>p(C.id),onEditTask:x},C.id)):s.jsxs("div",{className:"flex flex-col items-center justify-center w-full",children:[s.jsx("p",{className:"text-muted-foreground mb-4",children:"No columns found. Add a column to get started."}),s.jsxs($,{variant:"outline",onClick:()=>d(!0),className:"flex items-center gap-1",children:[s.jsx(Oe,{size:16}),"Add Column"]})]})}),s.jsx(Ys,{children:o?s.jsx(Fn,{task:o,onEdit:()=>{},className:"w-[350px] opacity-80"}):null})]})}),s.jsx(Ws,{open:c,onOpenChange:d,onSubmit:R}),f&&s.jsx(Hs,{open:u,onOpenChange:h,task:f,onSave:T,onDelete:L})]})}function Qa({initialBoardId:e}){const[t,n]=i.useState([]),[r,a]=i.useState(e||null),[o,l]=i.useState(!1),[c,d]=i.useState(""),[u,h]=i.useState(""),[f,v]=i.useState(!0),[g,S]=i.useState(!1),[m,b]=i.useState(null),[w,D]=i.useState(null),{toast:j}=mn(),M=[{title:"Kanban Boards",href:"/kanban"}];if(r){const p=t.find(x=>x.id===r);p&&M.push({title:p.name,href:`/kanban/${p.id}`})}i.useEffect(()=>{(async()=>{try{const x=await Z.checkAuth();D(x),x.authenticated||(b("Authentication failed. Please log in again."),j({title:"Authentication Error",description:"You need to log in again to access Kanban boards",variant:"destructive"}))}catch(x){console.error("Error checking auth status:",x),D({authenticated:!1}),b("Could not verify authentication status. Please try again later.")}})()},[]),i.useEffect(()=>{(async()=>{try{v(!0),b(null);const x=await Z.getBoards();n(x),!r&&x.length>0&&a(x[0].id)}catch(x){if(console.error("Error fetching boards:",x),O.isAxiosError(x)){const T=x;T.response?.status===401?(b("Authentication required. Please log in again."),j({title:"Authentication Error",description:"You need to log in again to access your Kanban boards",variant:"destructive"})):(b("Could not load your Kanban boards. Please try again later."),j({title:"Error loading boards",description:T.message||"Could not load your Kanban boards",variant:"destructive"}))}else b("Could not load your Kanban boards. Please try again later."),j({title:"Error loading boards",description:"An unexpected error occurred",variant:"destructive"})}finally{v(!1)}})()},[]);const E=async()=>{if(c.trim())try{S(!0),b(null);const p=await Z.createBoard({name:c.trim(),description:u.trim()||void 0,is_active:!0});n([...t,p]),a(p.id),l(!1),d(""),h(""),j({title:"Board created",description:"New Kanban board has been created successfully"})}catch(p){console.error("Error creating board:",p);const x=p;x.response?.status===401?b("Authentication required. Please log in again."):b("Could not create a new board. Please try again later."),j({title:"Error creating board",description:x.message||"Could not create a new board",variant:"destructive"})}finally{S(!1)}},R=async()=>{try{v(!0),b(null);const p=await Z.checkAuth();if(D(p),p.authenticated){const x=await Z.getBoards();n(x),x.length>0&&a(x[0].id),j({title:"Success",description:"Kanban boards loaded successfully"})}else b("Authentication required. Please log in again."),j({title:"Authentication Error",description:"You need to log in again to access your Kanban boards",variant:"destructive"})}catch(p){console.error("Error retrying:",p),b("Could not load your Kanban boards. Please try again later."),j({title:"Error",description:"Failed to refresh. Please try again later.",variant:"destructive"})}finally{v(!1)}};return s.jsxs(Hn,{breadcrumbs:M,children:[s.jsx(Wn,{title:r?`Kanban - ${t.find(p=>p.id===r)?.name||""}`:"Kanban Boards"}),s.jsxs("div",{className:"flex flex-col h-full",children:[w&&!w.authenticated&&s.jsxs(Vt,{variant:"destructive",className:"mb-4",children:[s.jsx(Qt,{className:"h-4 w-4"}),s.jsx(Jt,{children:"Authentication Error"}),s.jsx(Gt,{children:"You are not authenticated. Please log in again to access your Kanban boards."})]}),m&&s.jsxs(Vt,{variant:"destructive",className:"mb-4",children:[s.jsx(Qt,{className:"h-4 w-4"}),s.jsx(Jt,{children:"Error"}),s.jsxs(Gt,{className:"flex items-center justify-between",children:[s.jsx("span",{children:m}),s.jsxs($,{size:"sm",onClick:R,disabled:f,children:[s.jsx(ur,{className:"h-4 w-4 mr-1"}),"Retry"]})]})]}),s.jsxs("div",{className:"flex justify-between items-center p-4 border-b border-gray-200 dark:border-gray-700",children:[s.jsx("div",{className:"flex items-center gap-4",children:t.length>0&&s.jsxs("div",{className:"flex items-center",children:[s.jsx(Q,{htmlFor:"boardSelect",className:"mr-2",children:"Select Board:"}),s.jsx("select",{id:"boardSelect",value:r||"",onChange:p=>a(parseInt(p.target.value)),className:"border border-gray-300 dark:border-gray-600 rounded-md p-1 bg-background text-foreground",children:t.map(p=>s.jsx("option",{value:p.id,children:p.name},p.id))})]})}),s.jsx("div",{className:"flex gap-2",children:s.jsxs($,{variant:"default",size:"sm",onClick:()=>l(!0),children:[s.jsx(Oe,{className:"h-4 w-4 mr-1"}),"New Board"]})})]}),s.jsx("div",{className:"flex-1 overflow-hidden",children:f?s.jsx("div",{className:"flex items-center justify-center h-64",children:s.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-primary"})}):t.length===0?s.jsxs("div",{className:"flex flex-col items-center justify-center h-64 text-center p-4",children:[s.jsx(ir,{className:"h-12 w-12 text-gray-400 mb-4"}),s.jsx("h3",{className:"text-lg font-medium mb-2",children:"No Kanban Boards"}),s.jsx("p",{className:"text-gray-500 dark:text-gray-400 mb-4",children:"You don't have any Kanban boards yet. Create one to get started."}),s.jsxs($,{onClick:()=>l(!0),disabled:!w?.authenticated,children:[s.jsx(Oe,{size:16,className:"mr-1"}),"Create New Board"]})]}):r?s.jsx(Vs,{boardId:r}):s.jsx("div",{className:"flex items-center justify-center h-64",children:s.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:"Select a board to view"})})}),s.jsx(bt,{open:o,onOpenChange:l,children:s.jsxs(xt,{children:[s.jsx(yt,{children:s.jsx(wt,{children:"Create New Kanban Board"})}),s.jsxs("div",{className:"space-y-4 py-2",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx(Q,{htmlFor:"boardName",children:"Board Name"}),s.jsx(We,{id:"boardName",placeholder:"Enter board name",value:c,onChange:p=>d(p.target.value)})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(Q,{htmlFor:"boardDescription",children:"Description (optional)"}),s.jsx(bn,{id:"boardDescription",placeholder:"Enter board description",value:u,onChange:p=>h(p.target.value)})]})]}),s.jsxs(Ct,{children:[s.jsx($,{variant:"outline",onClick:()=>l(!1),children:"Cancel"}),s.jsxs($,{onClick:E,disabled:!c.trim()||g,children:[g?s.jsx("div",{className:"animate-spin h-4 w-4 border-2 border-current border-t-transparent rounded-full mr-1"}):null,"Create Board"]})]})]})})]})]})}export{Qa as default};
