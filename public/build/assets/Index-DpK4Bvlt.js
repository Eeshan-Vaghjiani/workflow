import{r as o,m,j as e,$ as z,Y as y}from"./app-EFdNlzF1.js";import{A as B}from"./admin-layout-CpXbS8hC.js";import{a as H}from"./index.module-DvtrWD_Y.js";import{C as N}from"./card-3d-Bo48T8xr.js";import{B as c}from"./button-CasVOQbR.js";import{T as V,a as Y,b as k,c as d,d as G,e as n}from"./table-Bnj2O6Zl.js";import{D,g as J,a as _,b as C,c as P}from"./dialog-COHCX9H9.js";import{I as x}from"./input-Bk2B3GPX.js";import{L as i}from"./label-DfE6wHIx.js";import{C as S}from"./checkbox-BH0k7zzB.js";import{B as U}from"./badge-DBoevtvU.js";import{g as K}from"./pdfUtils-DUNMNy8i.js";import{m as h}from"./proxy-CbQpuZ5T.js";import{P as Q}from"./plus-rumEydhk.js";import{S as W}from"./search-CVggSWwQ.js";import{F as X}from"./filter-BCyps47V.js";import{D as Z}from"./download-CTgQyxIJ.js";import{R as A}from"./refresh-cw-QjA5GgfD.js";import{S as ee}from"./square-pen-CKyWQhYX.js";import{T as ae}from"./trash-2-CZBbogeU.js";import{f as l}from"./format-C2sziSDG.js";import"./createLucideIcon-Ci57Z1nb.js";import"./users-BhyyQbJ9.js";import"./shield-Bj6jb4oM.js";import"./file-text-PMWQp7tq.js";import"./user-C97Zk_aQ.js";import"./chevron-down-mH0Ii3G_.js";import"./index-B8-Zcyzl.js";import"./settings-hZB-BaSU.js";import"./use-appearance-B35erkEd.js";import"./utils-CBfrqCZ4.js";import"./transition-CisZW2Lq.js";import"./with-selector-N-_QLJk-.js";import"./index-c1zC8zW2.js";import"./x-DQ3PVJ98.js";import"./check-CMJzhu6p.js";import"./typeof-QjJsDpFa.js";import"./jspdf.plugin.autotable-CZ1gY-nI.js";import"./en-US-CT0ADQGI.js";const re={hidden:{opacity:0},visible:{opacity:1,transition:{staggerChildren:.05}}},f={hidden:{opacity:0,y:20},visible:{opacity:1,y:0,transition:{type:"spring",stiffness:100,damping:15}}};function ze({users:s,filters:g}){const[b,F]=o.useState(g?.search||""),[p]=H(b,300),[T,u]=o.useState(!1),[E,j]=o.useState(!1),[v,w]=o.useState(null),[r,t]=o.useState({name:"",email:"",password:"",is_admin:!1});o.useEffect(()=>{p!==(g?.search||"")&&m.get(route("admin.users.index"),{search:p},{preserveState:!0,replace:!0})},[p,g?.search]);const I=a=>{a.preventDefault(),m.post("/admin/users",r,{onSuccess:()=>{u(!1),t({name:"",email:"",password:"",is_admin:!1})}})},R=a=>{a.preventDefault(),v&&m.put(`/admin/users/${v.id}`,r,{onSuccess:()=>{j(!1),w(null),t({name:"",email:"",password:"",is_admin:!1})}})},M=a=>{confirm("Are you sure you want to delete this user?")&&m.delete(`/admin/users/${a.id}`)},$=a=>{confirm("Are you sure you want to restore this user?")&&m.post(`/admin/users/${a.id}/restore`)},L=a=>{w(a),t({name:a.name,email:a.email,password:"",is_admin:a.role==="ADMIN"}),j(!0)},q=async()=>{try{await K({fileName:`users-report-${l(new Date,"yyyy-MM-dd")}.pdf`,reportTitle:"User Management Report",tables:[{title:"Active Users",head:[["ID","Name","Email","Role","Created","Last Login"]],body:s.data.filter(a=>!a.deleted_at).map(a=>[a.id,a.name,a.email,a.role,l(new Date(a.created_at),"PPP"),a.last_login_at?l(new Date(a.last_login_at),"PPP"):"Never"])},{title:"Deleted Users",head:[["ID","Name","Email","Role","Created","Deleted At"]],body:s.data.filter(a=>a.deleted_at).map(a=>[a.id,a.name,a.email,a.role,l(new Date(a.created_at),"PPP"),a.deleted_at?l(new Date(a.deleted_at),"PPP"):""])}]})}catch(a){console.error("Error exporting PDF:",a),alert("Failed to generate PDF report. Please try again.")}};return e.jsxs(B,{children:[e.jsx(z,{title:"User Management"}),e.jsxs(h.div,{className:"space-y-6",variants:re,initial:"hidden",animate:"visible",children:[e.jsxs(h.div,{variants:f,className:"flex flex-col md:flex-row md:items-center md:justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"User Management"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"Manage user accounts and permissions"})]}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsxs(D,{open:T,onOpenChange:u,children:[e.jsx(J,{asChild:!0,children:e.jsxs(c,{children:[e.jsx(Q,{className:"h-4 w-4 mr-2"}),"Add User"]})}),e.jsxs(_,{children:[e.jsx(C,{children:e.jsx(P,{children:"Add New User"})}),e.jsxs("form",{onSubmit:I,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(i,{htmlFor:"name",children:"Name"}),e.jsx(x,{id:"name",value:r.name,onChange:a=>t({...r,name:a.target.value}),required:!0})]}),e.jsxs("div",{children:[e.jsx(i,{htmlFor:"email",children:"Email"}),e.jsx(x,{id:"email",type:"email",value:r.email,onChange:a=>t({...r,email:a.target.value}),required:!0})]}),e.jsxs("div",{children:[e.jsx(i,{htmlFor:"password",children:"Password"}),e.jsx(x,{id:"password",type:"password",value:r.password,onChange:a=>t({...r,password:a.target.value}),required:!0})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(S,{id:"is_admin",checked:r.is_admin,onCheckedChange:a=>t({...r,is_admin:a})}),e.jsx(i,{htmlFor:"is_admin",children:"Admin User"})]}),e.jsx(c,{type:"submit",className:"w-full",children:"Add User"})]})]})]})})]}),e.jsx(h.div,{variants:f,children:e.jsx(N,{className:"bg-white dark:bg-gray-800 p-4 rounded-lg border border-gray-200 dark:border-gray-700",children:e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center justify-between gap-4",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 flex items-center pl-3 pointer-events-none",children:e.jsx(W,{className:"h-4 w-4 text-gray-400"})}),e.jsx("input",{type:"search",className:"block w-full pl-10 pr-4 py-2 text-sm border border-gray-200 dark:border-gray-700 rounded-lg bg-gray-50 dark:bg-gray-900 text-gray-900 dark:text-white focus:ring-[#00887A] focus:border-[#00887A] dark:focus:ring-[#00ccb4] dark:focus:border-[#00ccb4]",placeholder:"Search users by name or email...",value:b,onChange:a=>F(a.target.value)})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("button",{className:"flex items-center px-3 py-2 text-sm font-medium text-gray-700 dark:text-gray-300 bg-gray-100 dark:bg-gray-700 rounded-lg hover:bg-gray-200 dark:hover:bg-gray-600 transition-colors",disabled:!0,children:[e.jsx(X,{className:"h-4 w-4 mr-2"}),"Filter"]}),e.jsxs("button",{className:"flex items-center px-3 py-2 text-sm font-medium text-gray-700 dark:text-gray-300 bg-gray-100 dark:bg-gray-700 rounded-lg hover:bg-gray-200 dark:hover:bg-gray-600 transition-colors",onClick:q,children:[e.jsx(Z,{className:"h-4 w-4 mr-2"}),"Export"]}),e.jsx("button",{className:"flex items-center px-3 py-2 text-sm font-medium text-gray-700 dark:text-gray-300 bg-gray-100 dark:bg-gray-700 rounded-lg hover:bg-gray-200 dark:hover:bg-gray-600 transition-colors",onClick:()=>m.reload(),children:e.jsx(A,{className:"h-4 w-4"})})]})]})})}),e.jsx(h.div,{variants:f,children:e.jsxs(N,{className:"bg-white dark:bg-gray-800 overflow-hidden border border-gray-200 dark:border-gray-700 rounded-lg",children:[e.jsx("div",{className:"overflow-x-auto",children:e.jsxs(V,{children:[e.jsx(Y,{children:e.jsxs(k,{children:[e.jsx(d,{children:"Name"}),e.jsx(d,{children:"Email"}),e.jsx(d,{children:"Role"}),e.jsx(d,{children:"Created"}),e.jsx(d,{children:"Last Login"}),e.jsx(d,{children:"Status"}),e.jsx(d,{children:"Actions"})]})}),e.jsx(G,{children:s.data.map(a=>e.jsxs(k,{children:[e.jsx(n,{children:a.name}),e.jsx(n,{children:a.email}),e.jsx(n,{children:e.jsx(U,{variant:a.role==="ADMIN"?"default":"secondary",children:a.role})}),e.jsx(n,{children:l(new Date(a.created_at),"PPP")}),e.jsx(n,{children:a.last_login_at?l(new Date(a.last_login_at),"PPP"):"Never"}),e.jsx(n,{children:e.jsx(U,{variant:a.deleted_at?"danger":"success",children:a.deleted_at?"Deleted":"Active"})}),e.jsx(n,{children:e.jsx("div",{className:"flex items-center gap-2",children:a.deleted_at?e.jsx(c,{variant:"ghost",size:"icon",onClick:()=>$(a),children:e.jsx(A,{className:"w-4 h-4"})}):e.jsxs(e.Fragment,{children:[e.jsx(c,{variant:"ghost",size:"icon",onClick:()=>L(a),children:e.jsx(ee,{className:"w-4 h-4"})}),e.jsx(c,{variant:"ghost",size:"icon",onClick:()=>M(a),children:e.jsx(ae,{className:"w-4 h-4"})})]})})})]},a.id))})]})}),s.links.length>3&&e.jsxs("div",{className:"border-t border-gray-200 dark:border-gray-700 px-4 py-3 flex items-center justify-between",children:[e.jsxs("div",{className:"flex-1 flex justify-between sm:hidden",children:[e.jsx(y,{href:s.links[0].url||"",className:`relative inline-flex items-center px-4 py-2 text-sm font-medium rounded-md ${s.links[0].url?"text-gray-700 dark:text-gray-200 bg-white dark:bg-gray-800 border border-gray-300 dark:border-gray-600":"text-gray-400 bg-gray-200 dark:bg-gray-700"}`,children:"Previous"}),e.jsx(y,{href:s.links[s.links.length-1].url||"",className:`ml-3 relative inline-flex items-center px-4 py-2 text-sm font-medium rounded-md ${s.links[s.links.length-1].url?"text-gray-700 dark:text-gray-200 bg-white dark:bg-gray-800 border border-gray-300 dark:border-gray-600":"text-gray-400 bg-gray-200 dark:bg-gray-700"}`,children:"Next"})]}),e.jsxs("div",{className:"hidden sm:flex-1 sm:flex sm:items-center sm:justify-between",children:[e.jsx("div",{children:e.jsxs("p",{className:"text-sm text-gray-700 dark:text-gray-400",children:["Showing ",e.jsx("span",{className:"font-medium",children:s.from})," to ",e.jsx("span",{className:"font-medium",children:s.to})," of"," ",e.jsx("span",{className:"font-medium",children:s.total})," results"]})}),e.jsx("div",{children:e.jsx("nav",{className:"relative z-0 inline-flex rounded-md shadow-sm -space-x-px","aria-label":"Pagination",children:s.links.map((a,O)=>e.jsx(y,{href:a.url||"",className:`relative inline-flex items-center px-4 py-2 text-sm font-medium ${a.active?"z-10 bg-indigo-50 border-indigo-500 text-indigo-600":"bg-white border-gray-300 text-gray-500 hover:bg-gray-50"} dark:bg-gray-800 dark:border-gray-700 dark:text-gray-300 dark:hover:bg-gray-700`,dangerouslySetInnerHTML:{__html:a.label}},O))})})]})]})]})})]}),e.jsx(D,{open:E,onOpenChange:j,children:e.jsxs(_,{children:[e.jsx(C,{children:e.jsx(P,{children:"Edit User"})}),e.jsxs("form",{onSubmit:R,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(i,{htmlFor:"edit-name",children:"Name"}),e.jsx(x,{id:"edit-name",value:r.name,onChange:a=>t({...r,name:a.target.value}),required:!0})]}),e.jsxs("div",{children:[e.jsx(i,{htmlFor:"edit-email",children:"Email"}),e.jsx(x,{id:"edit-email",type:"email",value:r.email,onChange:a=>t({...r,email:a.target.value}),required:!0})]}),e.jsxs("div",{children:[e.jsx(i,{htmlFor:"edit-password",children:"Password (leave blank to keep current)"}),e.jsx(x,{id:"edit-password",type:"password",value:r.password,onChange:a=>t({...r,password:a.target.value})})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(S,{id:"edit-is_admin",checked:r.is_admin,onCheckedChange:a=>t({...r,is_admin:a})}),e.jsx(i,{htmlFor:"edit-is_admin",children:"Admin User"})]}),e.jsx(c,{type:"submit",className:"w-full",children:"Update User"})]})]})})]})}export{ze as default};
