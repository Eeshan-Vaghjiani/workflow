import{r as x,R as G,j as e,$ as S,Y as k,a as I,A as D}from"./app-EFdNlzF1.js";import{B as o}from"./button-CasVOQbR.js";import{e as R,C as _,a as A,b as T,c as Y,d as L}from"./card-BCz-9kZc.js";import{A as u,a as h,b as g}from"./alert-BD6n4Q_B.js";import{I as O}from"./input-Bk2B3GPX.js";import{L as F}from"./label-DfE6wHIx.js";import{S as B}from"./separator-BEFBTD2w.js";import{A as W}from"./app-layout-0nbQuyMj.js";import{u as $}from"./use-toast-CANIoCn8.js";import{C as b}from"./circle-alert-De98Sfo_.js";import{C as q}from"./circle-check-big-Zn6OYsr0.js";import{C as H}from"./calendar-BAuuk18F.js";import"./utils-CBfrqCZ4.js";import"./index-DZoa35Y7.js";import"./index-c1zC8zW2.js";import"./app-sidebar-layout-2N2f9zf2.js";import"./dropdown-menu-Be5dVAII.js";import"./index-W8SXwZza.js";import"./index-z8h15STC.js";import"./index-CXYmmwmY.js";import"./avatar-DTxGSWKN.js";import"./index-B4gP1Yw4.js";import"./createLucideIcon-Ci57Z1nb.js";import"./use-animation-WpyryXH0.js";import"./use-animation-BzGI8ib-.js";import"./proxy-CbQpuZ5T.js";import"./chevron-right-BAVANYz7.js";import"./users-BhyyQbJ9.js";import"./square-check-big-DO1D6uu6.js";import"./credit-card-BbHoo0vm.js";import"./user-C97Zk_aQ.js";import"./use-appearance-B35erkEd.js";import"./sun-Dv7cDcCR.js";import"./settings-hZB-BaSU.js";import"./glass-container-DKPWOAO6.js";import"./index-B8-Zcyzl.js";function Ge({googleCalendarConnected:c,googleCalendarInfo:n,configValid:l=!0,googleAuthUrl:j,error:d,flash:t}){const{toast:r}=$(),[i,y]=x.useState(!1),[f,v]=x.useState(!1),[m,N]=x.useState(n?.calendar_id||"");G.useEffect(()=>{t?.success&&r({title:"Success",description:t.success,variant:"default"}),t?.error&&r({title:"Error",description:t.error,variant:"destructive"}),d&&r({title:"Error",description:d,variant:"destructive"})},[t,d,r]);const C=()=>{if(j){y(!0),window.location.href=j;return}y(!0),window.location.href=route("google.auth")},w=async p=>{if(p.preventDefault(),!c){r({title:"Error",description:"You need to connect your Google account first.",variant:"destructive"});return}v(!0);try{const s=document.querySelector('meta[name="csrf-token"]')?.getAttribute("content"),a=await I.post(route("calendar.save-settings"),{calendar_id:m},{headers:{"X-CSRF-TOKEN":s,"Content-Type":"application/json",Accept:"application/json"}});if(a.data.success)r({title:"Success",description:"Google Calendar ID saved successfully.",variant:"default"});else throw new Error(a.data.message||"Failed to save calendar ID")}catch(s){console.error("Error saving calendar ID:",s);let a="Failed to save calendar ID";s instanceof D?a=s.response?.data?.message||s.message:s instanceof Error&&(a=s.message),r({title:"Error",description:a,variant:"destructive"})}finally{v(!1)}},E=[{title:"Calendar",href:"/dashboard/calendar"},{title:"Settings",href:"/calendar/settings"}];return e.jsxs(W,{breadcrumbs:E,children:[e.jsx(S,{title:"Calendar Settings"}),e.jsx("div",{className:"py-12",children:e.jsx("div",{className:"max-w-7xl mx-auto sm:px-6 lg:px-8",children:e.jsx("div",{className:"bg-white overflow-hidden shadow-sm sm:rounded-lg",children:e.jsxs("div",{className:"p-6 text-gray-900",children:[e.jsx("h1",{className:"text-2xl font-semibold mb-6",children:"Calendar Settings"}),!l&&e.jsxs(u,{className:"mb-6 bg-amber-50 border-amber-200",children:[e.jsx(b,{className:"h-4 w-4"}),e.jsx(h,{children:"Configuration Warning"}),e.jsx(g,{children:"Google Calendar integration is not properly configured. Please check your server's environment variables for GOOGLE_CLIENT_ID, GOOGLE_CLIENT_SECRET, and GOOGLE_REDIRECT_URI."})]}),e.jsxs(R,{children:[e.jsxs(_,{children:[e.jsx(A,{children:"Google Calendar Integration"}),e.jsx(T,{children:"Connect your Google Calendar to sync tasks and assignments"})]}),e.jsx(Y,{children:c?e.jsxs("div",{className:"space-y-4",children:[e.jsxs(u,{className:"bg-green-50 border-green-200",children:[e.jsx(q,{className:"h-4 w-4"}),e.jsx(h,{children:"Connected"}),e.jsx(g,{children:"Your Google Calendar is connected and working properly."})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"font-medium",children:"Connected on:"}),e.jsx("span",{className:"text-gray-600",children:n?.connected_at})]}),n?.expires_at&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"font-medium",children:"Token expires:"}),e.jsx("span",{className:"text-gray-600",children:n.expires_at})]})]}),e.jsx(B,{className:"my-4"}),e.jsxs("form",{onSubmit:w,className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(F,{htmlFor:"calendar-id",children:"Google Calendar ID"}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(H,{className:"w-4 h-4 text-gray-400"}),e.jsx(O,{id:"calendar-id",value:m,onChange:p=>N(p.target.value),placeholder:"primary or your_calendar_id@group.calendar.google.com",className:"flex-1"})]}),e.jsx("p",{className:"text-sm text-gray-500",children:'Use "primary" for your main calendar or enter a specific calendar ID. You can find your calendar ID in Google Calendar settings.'})]}),e.jsx(o,{type:"submit",disabled:f||!m,children:f?"Saving...":"Save Calendar ID"})]})]}):e.jsxs("div",{className:"space-y-4",children:[e.jsxs(u,{className:"bg-blue-50 border-blue-200",children:[e.jsx(b,{className:"h-4 w-4"}),e.jsx(h,{children:"Not Connected"}),e.jsx(g,{children:"Connect your Google Calendar to sync tasks and assignments automatically."})]}),e.jsx("p",{className:"text-sm text-gray-600",children:"When you connect your Google Calendar, we'll automatically create events for your tasks and assignments. Any changes you make to your tasks will be reflected in your calendar."}),e.jsxs("div",{className:"bg-gray-50 dark:bg-gray-800 rounded-md p-4 border border-gray-200 dark:border-gray-700",children:[e.jsx("h4",{className:"font-medium mb-2",children:"What to expect:"}),e.jsxs("ul",{className:"list-disc list-inside text-sm space-y-1 text-gray-600 dark:text-gray-400",children:[e.jsx("li",{children:"You'll be prompted to select which Google account to use"}),e.jsx("li",{children:"You can choose any Google account, not just the one you use to log in"}),e.jsx("li",{children:"Google will ask for permission to access your calendar"}),e.jsx("li",{children:"You'll be redirected back to this page after connecting"}),e.jsx("li",{children:"You'll need to specify which calendar to use for syncing"})]})]})]})}),e.jsx(L,{children:c?e.jsxs("div",{className:"flex space-x-4",children:[e.jsx(o,{onClick:C,variant:"secondary",disabled:!l||i,children:i?"Redirecting...":"Reconnect Calendar"}),e.jsx(o,{asChild:!0,variant:"destructive",disabled:i,children:e.jsx(k,{href:route("google.disconnect"),children:"Disconnect"})})]}):e.jsx(o,{onClick:C,disabled:!l||i,children:i?"Redirecting...":"Connect Google Calendar"})})]})]})})})})]})}export{Ge as default};
