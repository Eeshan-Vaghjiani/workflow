import{r as l,v as g,j as e,$ as _}from"./app-EFdNlzF1.js";import{I as f}from"./input-error-D-sUjSCg.js";import{S as I,H}from"./layout-CewRPm2M.js";import{B as t}from"./button-CasVOQbR.js";import{e as m,C as u,a as h,b as x,c as p}from"./card-BCz-9kZc.js";import{I as y}from"./input-Bk2B3GPX.js";import{L as b}from"./label-DfE6wHIx.js";import{A as L,b as B}from"./alert-BD6n4Q_B.js";import{B as P}from"./badge-DBoevtvU.js";import{A as W}from"./app-layout-0nbQuyMj.js";import"./utils-CBfrqCZ4.js";import"./separator-BEFBTD2w.js";import"./index-DZoa35Y7.js";import"./index-c1zC8zW2.js";import"./app-sidebar-layout-2N2f9zf2.js";import"./dropdown-menu-Be5dVAII.js";import"./index-W8SXwZza.js";import"./index-z8h15STC.js";import"./index-CXYmmwmY.js";import"./avatar-DTxGSWKN.js";import"./index-B4gP1Yw4.js";import"./createLucideIcon-Ci57Z1nb.js";import"./use-animation-WpyryXH0.js";import"./use-animation-BzGI8ib-.js";import"./proxy-CbQpuZ5T.js";import"./chevron-right-BAVANYz7.js";import"./users-BhyyQbJ9.js";import"./square-check-big-DO1D6uu6.js";import"./calendar-BAuuk18F.js";import"./credit-card-BbHoo0vm.js";import"./user-C97Zk_aQ.js";import"./use-appearance-B35erkEd.js";import"./sun-Dv7cDcCR.js";import"./settings-hZB-BaSU.js";import"./glass-container-DKPWOAO6.js";import"./index-B8-Zcyzl.js";const Y=[{title:"Two-Factor Authentication",href:"/settings/two-factor-auth"}];function ke({enabled:d,qrCode:N,recoveryCodes:S,confirming:C}){const[R,j]=l.useState(!1),[F,w]=l.useState(!1),[v,k]=l.useState(!1),a=l.useRef(null),s=l.useRef(null),o=g({code:""}),i=g({code:""}),c=g({password:""}),n=g({password:""}),D=r=>{r.preventDefault(),o.post(route("two-factor.store"),{preserveScroll:!0,onSuccess:()=>{o.reset(),k(!0)},onError:()=>{s.current&&s.current.focus()}})},A=r=>{r.preventDefault(),i.put(route("two-factor.update"),{preserveScroll:!0,onSuccess:()=>{i.reset()},onError:()=>{s.current&&s.current.focus()}})},T=r=>{r.preventDefault(),c.delete(route("two-factor.destroy"),{preserveScroll:!0,onSuccess:()=>{c.reset(),j(!1)},onError:()=>{a.current&&a.current.focus()}})},E=r=>{r.preventDefault(),n.post(route("two-factor.recovery-codes"),{preserveScroll:!0,onSuccess:()=>{n.reset(),w(!1),k(!0)},onError:()=>{a.current&&a.current.focus()}})};return e.jsxs(W,{breadcrumbs:Y,children:[e.jsx(_,{title:"Two-Factor Authentication"}),e.jsx(I,{children:e.jsxs("div",{className:"space-y-8 max-w-4xl",children:[e.jsx(H,{title:"Two-Factor Authentication",description:"Add additional security to your account using two-factor authentication."}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-md px-6 py-5 border border-gray-200 dark:border-gray-700 flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-medium dark:text-white",children:d?"You have enabled two-factor authentication":"You have not enabled two-factor authentication"}),e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 mt-1",children:"When two-factor authentication is enabled, you will be prompted for a secure, random token during authentication."})]}),e.jsx("div",{children:d&&e.jsx(P,{className:"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-100 hover:bg-green-100 dark:hover:bg-green-900",children:"Enabled"})})]}),!d&&e.jsxs(m,{children:[e.jsxs(u,{children:[e.jsx(h,{className:"dark:text-white",children:"Set up two-factor authentication"}),e.jsx(x,{className:"dark:text-gray-300",children:"Secure your account with two-factor authentication. When enabled, you'll be prompted for a secure, random token during login."})]}),e.jsxs(p,{children:[N&&e.jsxs("div",{className:"mt-4",children:[e.jsx("p",{className:"text-sm text-gray-600 mb-2",children:"To enable two-factor authentication, scan the following QR code using your phone's authenticator application, then enter the verification code."}),e.jsx("div",{className:"mx-auto mt-4 max-w-xs p-4 bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-lg",dangerouslySetInnerHTML:{__html:N}})]}),C&&e.jsxs("form",{onSubmit:A,className:"mt-6",children:[e.jsxs("div",{children:[e.jsx(b,{htmlFor:"code",className:"dark:text-gray-300",children:"Verification Code"}),e.jsx(y,{id:"code",type:"text",name:"code",className:"mt-1 block w-full dark:bg-gray-700 dark:text-gray-200 dark:border-gray-600",value:i.data.code,onChange:r=>i.setData("code",r.target.value),autoComplete:"one-time-code",ref:s}),e.jsx(f,{message:i.errors.code,className:"mt-2"})]}),e.jsx("div",{className:"mt-6",children:e.jsx(t,{type:"submit",className:"ml-auto",disabled:i.processing,children:"Confirm"})})]}),!C&&e.jsx("form",{onSubmit:D,className:"mt-6",children:e.jsxs("div",{children:[e.jsx(b,{htmlFor:"code",className:"dark:text-gray-300",children:"Verification Code"}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(y,{id:"code",type:"text",name:"code",className:"mt-1 block w-full dark:bg-gray-700 dark:text-gray-200 dark:border-gray-600",value:o.data.code,onChange:r=>o.setData("code",r.target.value),autoComplete:"one-time-code",ref:s,placeholder:"6-digit verification code"}),e.jsx(t,{type:"submit",disabled:o.processing,children:"Enable"})]}),e.jsx(f,{message:o.errors.code,className:"mt-2"})]})})]})]}),d&&e.jsxs("div",{className:"space-y-8",children:[e.jsxs(m,{children:[e.jsxs(u,{children:[e.jsx(h,{className:"dark:text-white",children:"Recovery Codes"}),e.jsx(x,{className:"dark:text-gray-300",children:"Store these recovery codes in a secure password manager. They can be used to recover access to your account if your authenticator device is lost."})]}),e.jsxs(p,{children:[e.jsxs("div",{className:"flex items-center gap-4 mb-4",children:[e.jsx(t,{type:"button",onClick:()=>k(!v),variant:"outline",children:v?"Hide Recovery Codes":"Show Recovery Codes"}),e.jsx(t,{type:"button",onClick:()=>w(!0),variant:"outline",children:"Regenerate Recovery Codes"})]}),v&&e.jsx(L,{variant:"default",className:"mt-4 bg-gray-50 dark:bg-gray-800 border-gray-200 dark:border-gray-700",children:e.jsxs(B,{children:[e.jsx("div",{className:"mb-4 text-sm text-gray-600 dark:text-gray-300",children:"Store these recovery codes in a secure password manager. They can be used to recover access to your account if your two-factor authentication device is lost."}),e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-2 rounded-md bg-gray-100 dark:bg-gray-900 px-4 py-4 font-mono text-sm",children:S.map(r=>e.jsx("div",{className:"truncate dark:text-gray-300",children:r},r))})]})})]})]}),e.jsxs(m,{children:[e.jsxs(u,{children:[e.jsx(h,{className:"dark:text-white",children:"Disable Two-Factor Authentication"}),e.jsx(x,{className:"dark:text-gray-300",children:"You can disable two-factor authentication if you no longer wish to use it."})]}),e.jsx(p,{children:e.jsx(t,{type:"button",onClick:()=>j(!0),variant:"destructive",children:"Disable Two-Factor Authentication"})})]})]}),R&&e.jsxs(m,{className:"border-red-200 bg-red-50 dark:bg-red-950 dark:border-red-900",children:[e.jsxs(u,{children:[e.jsx(h,{className:"dark:text-white",children:"Disable two-factor authentication"}),e.jsx(x,{className:"dark:text-gray-300",children:"Please enter your password to confirm you would like to disable two-factor authentication."})]}),e.jsx(p,{children:e.jsxs("form",{onSubmit:T,children:[e.jsxs("div",{children:[e.jsx(b,{htmlFor:"password",className:"dark:text-gray-300",children:"Password"}),e.jsx(y,{id:"password",type:"password",name:"password",className:"mt-1 block w-full dark:bg-gray-700 dark:text-gray-200 dark:border-gray-600",value:c.data.password,onChange:r=>c.setData("password",r.target.value),autoComplete:"current-password",ref:a}),e.jsx(f,{message:c.errors.password,className:"mt-2"})]}),e.jsxs("div",{className:"mt-6 flex items-center justify-end",children:[e.jsx(t,{type:"button",variant:"outline",onClick:()=>j(!1),className:"mr-3",children:"Cancel"}),e.jsx(t,{type:"submit",variant:"destructive",disabled:c.processing,children:"Disable"})]})]})})]}),F&&e.jsxs(m,{children:[e.jsxs(u,{children:[e.jsx(h,{className:"dark:text-white",children:"Regenerate recovery codes"}),e.jsx(x,{className:"dark:text-gray-300",children:"Please enter your password to confirm you would like to regenerate your recovery codes."})]}),e.jsx(p,{children:e.jsxs("form",{onSubmit:E,children:[e.jsxs("div",{children:[e.jsx(b,{htmlFor:"password_for_recovery_code_generation",className:"dark:text-gray-300",children:"Password"}),e.jsx(y,{id:"password_for_recovery_code_generation",type:"password",name:"password",className:"mt-1 block w-full dark:bg-gray-700 dark:text-gray-200 dark:border-gray-600",value:n.data.password,onChange:r=>n.setData("password",r.target.value),autoComplete:"current-password",ref:a}),e.jsx(f,{message:n.errors.password,className:"mt-2"})]}),e.jsxs("div",{className:"mt-6 flex items-center justify-end",children:[e.jsx(t,{type:"button",variant:"outline",onClick:()=>w(!1),className:"mr-3",children:"Cancel"}),e.jsx(t,{type:"submit",disabled:n.processing,children:"Regenerate"})]})]})})]})]})})]})}export{ke as default};
