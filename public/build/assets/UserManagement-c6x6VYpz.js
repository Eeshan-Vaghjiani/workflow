import{j as e,r as o,$ as H,R as X}from"./app-Cz-XC9l4.js";import{A as G}from"./admin-layout-CXWzcWrg.js";import{e as _,c as D,C as J,a as Q}from"./card-tSD26EUH.js";import{B as n}from"./button-Diu-54fO.js";import{c as N}from"./utils-CBfrqCZ4.js";import{C as V}from"./chevron-up-BkkBLiNV.js";import{C as W}from"./chevron-down-C-4IPUEA.js";import{c as z}from"./createLucideIcon-CfQhLZuM.js";import{B as A}from"./badge-DxpFCqhw.js";import{I as Y}from"./input-gyYvXWbp.js";import{S as w,U as Z}from"./stat-card-sgdjJfc1.js";import{U as E,u as U}from"./UserFormModal-B26i_r2k.js";import{P as ee}from"./plus-ax70JYGI.js";import{U as se}from"./users-Da4X3jqK.js";import{U as re}from"./user-plus-hvQUeLIe.js";import{S as te}from"./search-CSzBP2dH.js";import{F as ae}from"./filter-owsWGZDV.js";import{D as ne}from"./download-DAIgTXra.js";import{R as I}from"./refresh-cw-CvPiLkiZ.js";import{S as ie}from"./square-pen-Dr4lgTIH.js";import{T as oe}from"./trash-2-DglzZvlY.js";import"./proxy-DUnCzY_P.js";import"./shield-BfMvo9My.js";import"./file-text-BrTovKwn.js";import"./user-ILuj1RD-.js";import"./index-B0-ktvjH.js";import"./settings-DpzlEckF.js";import"./use-appearance-rE9bUEXS.js";import"./dialog-DfYwz7rS.js";import"./transition-DECp-BFe.js";import"./with-selector-Bs5_a5KJ.js";import"./index-BUtF6_nR.js";import"./x-J8IMCWLS.js";import"./label-TRCAcQVD.js";import"./checkbox-jHuaGxxD.js";import"./check-DpDReKzm.js";/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const le=[["path",{d:"m7 15 5 5 5-5",key:"1hf1tw"}],["path",{d:"m7 9 5-5 5 5",key:"sgt6xg"}]],ce=z("ChevronsUpDown",le);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const de=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"17",x2:"22",y1:"8",y2:"13",key:"3nzzx3"}],["line",{x1:"22",x2:"17",y1:"8",y2:"13",key:"1swrse"}]],me=z("UserX",de);function xe({data:m,columns:x,onRowClick:p,isLoading:b=!1,className:f,emptyMessage:a="No data available",sortField:j,sortDirection:l,onSort:h,rowClassName:c}){const k=t=>{if(!t.sortable||!h)return;const i=t.id;h(i,j===i&&l==="asc"?"desc":"asc")},P=t=>t.sortable?j===t.id?l==="asc"?e.jsx(V,{className:"h-4 w-4 ml-1"}):e.jsx(W,{className:"h-4 w-4 ml-1"}):e.jsx(ce,{className:"h-4 w-4 ml-1 opacity-50"}):null;return e.jsx("div",{className:N("w-full overflow-auto",f),children:e.jsxs("table",{className:"w-full border-collapse",children:[e.jsx("thead",{children:e.jsx("tr",{className:"bg-gray-50 dark:bg-gray-800/50 border-b border-gray-200 dark:border-gray-700",children:x.map(t=>e.jsx("th",{className:N("px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",t.sortable&&"cursor-pointer select-none",t.className),onClick:()=>t.sortable&&k(t),children:e.jsxs("div",{className:"flex items-center",children:[t.header,P(t)]})},t.id))})}),e.jsx("tbody",{className:"bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700",children:b?e.jsx("tr",{children:e.jsx("td",{colSpan:x.length,className:"px-4 py-4 text-center text-sm text-gray-500 dark:text-gray-400",children:e.jsxs("div",{className:"flex justify-center items-center space-x-2",children:[e.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-t-2 border-b-2 border-primary-500"}),e.jsx("span",{children:"Loading..."})]})})}):m.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:x.length,className:"px-4 py-4 text-center text-sm text-gray-500 dark:text-gray-400",children:a})}):m.map(t=>e.jsx("tr",{className:N("hover:bg-gray-50 dark:hover:bg-gray-700/50 transition-colors",p&&"cursor-pointer",c&&c(t)),onClick:()=>p&&p(t),children:x.map(i=>e.jsx("td",{className:N("px-4 py-3 text-sm text-gray-900 dark:text-gray-200",i.className),children:i.cell?i.cell(t):i.accessorKey?String(t[i.accessorKey]??""):null},`${t.id}-${i.id}`))},t.id))})]})})}const he=o.createContext(void 0),pe=()=>{const m=o.useContext(he);if(m===void 0)throw new Error("useTheme must be used within a ThemeProvider");return m};function We(){const{theme:m}=pe(),[x,p]=o.useState([]),[b,f]=o.useState(!0),[a,j]=o.useState({total:0,perPage:10,currentPage:1,lastPage:1}),[l,h]=o.useState({search:"",sort_field:"created_at",sort_direction:"desc",page:1,per_page:10}),[c,k]=o.useState({totalUsers:0,activeUsers:0,adminUsers:0,deletedUsers:0}),[P,t]=o.useState(!1),[i,y]=o.useState(!1),[F,C]=o.useState(null),g=async()=>{f(!0);try{const s=await U.getUsers(l);p(s.users),j(s.meta);const r=s.meta.total,d=s.users.filter(u=>!u.deleted).length,K=s.users.filter(u=>u.role==="ADMIN").length,q=s.users.filter(u=>u.deleted).length;k({totalUsers:r,activeUsers:d,adminUsers:K,deletedUsers:q})}catch(s){console.error("Error fetching users:",s)}finally{f(!1)}};o.useEffect(()=>{g()},[l]);const L=s=>{const r=s.target.value;h(d=>({...d,search:r,page:1}))},M=(s,r)=>{h(d=>({...d,sort_field:s,sort_direction:r}))},v=s=>{h(r=>({...r,page:s}))},T=async s=>{if(window.confirm(`Are you sure you want to delete ${s.name}?`))try{await U.deleteUser(s.id),g()}catch(r){console.error("Error deleting user:",r)}},$=async s=>{if(window.confirm(`Are you sure you want to restore ${s.name}?`))try{await U.restoreUser(s.id),g()}catch(r){console.error("Error restoring user:",r)}},O=s=>{C(s),y(!0)},S=()=>{t(!1),y(!1),C(null),g()},R=async()=>{try{await U.downloadPdf()}catch(s){console.error("Error downloading PDF:",s)}},B=[{id:"name",header:"Name",accessorKey:"name",sortable:!0},{id:"email",header:"Email",accessorKey:"email",sortable:!0},{id:"role",header:"Role",cell:s=>e.jsx(A,{variant:s.role==="ADMIN"?"default":"secondary",children:s.role}),sortable:!1},{id:"created_at",header:"Created",cell:s=>new Date(s.created_at).toLocaleDateString(),sortable:!0},{id:"last_login_at",header:"Last Login",cell:s=>s.last_login_at?new Date(s.last_login_at).toLocaleDateString():"Never",sortable:!0},{id:"status",header:"Status",cell:s=>e.jsx(A,{variant:s.deleted?"danger":"success",children:s.deleted?"Deleted":"Active"}),sortable:!1},{id:"actions",header:"Actions",cell:s=>e.jsx("div",{className:"flex items-center gap-2",children:s.deleted?e.jsx(n,{variant:"ghost",size:"icon",onClick:r=>{r.stopPropagation(),$(s)},children:e.jsx(I,{className:"w-4 h-4"})}):e.jsxs(e.Fragment,{children:[e.jsx(n,{variant:"ghost",size:"icon",onClick:r=>{r.stopPropagation(),O(s)},children:e.jsx(ie,{className:"w-4 h-4"})}),e.jsx(n,{variant:"ghost",size:"icon",onClick:r=>{r.stopPropagation(),T(s)},children:e.jsx(oe,{className:"w-4 h-4"})})]})}),sortable:!1}];return e.jsxs(G,{children:[e.jsx(H,{title:"User Management"}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"User Management"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"Manage user accounts and permissions"})]}),e.jsx(n,{leftIcon:e.jsx(ee,{className:"h-5 w-5"}),onClick:()=>t(!0),children:"Add New User"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsx(w,{title:"Total Users",value:c.totalUsers,icon:e.jsx(se,{className:"h-5 w-5 text-[#00887A] dark:text-[#00ccb4]"})}),e.jsx(w,{title:"Active Users",value:c.activeUsers,icon:e.jsx(Z,{className:"h-5 w-5 text-green-600 dark:text-green-400"})}),e.jsx(w,{title:"Admin Users",value:c.adminUsers,icon:e.jsx(re,{className:"h-5 w-5 text-blue-600 dark:text-blue-400"})}),e.jsx(w,{title:"Deleted Users",value:c.deletedUsers,icon:e.jsx(me,{className:"h-5 w-5 text-red-600 dark:text-red-400"})})]}),e.jsx(_,{children:e.jsx(D,{className:"p-4",children:e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center justify-between gap-4",children:[e.jsx("div",{className:"relative flex-1",children:e.jsx(Y,{type:"search",placeholder:"Search users...",value:l.search,onChange:L,leftIcon:e.jsx(te,{className:"h-4 w-4"})})}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(n,{variant:"secondary",leftIcon:e.jsx(ae,{className:"h-4 w-4"}),children:"Filter"}),e.jsx(n,{variant:"secondary",leftIcon:e.jsx(ne,{className:"h-4 w-4"}),onClick:R,children:"Export PDF"}),e.jsx(n,{variant:"secondary",size:"icon",onClick:()=>g(),children:e.jsx(I,{className:"h-4 w-4"})})]})]})})}),e.jsxs(_,{children:[e.jsx(J,{children:e.jsx(Q,{children:"Users"})}),e.jsxs(D,{children:[e.jsx(xe,{data:x,columns:B,isLoading:b,sortField:l.sort_field,sortDirection:l.sort_direction,onSort:M,rowClassName:s=>s.deleted?"opacity-60":""}),a.lastPage>1&&e.jsxs("div",{className:"flex justify-between items-center mt-4 px-4 py-3 border-t border-gray-200 dark:border-gray-700",children:[e.jsx("div",{children:e.jsxs("p",{className:"text-sm text-gray-700 dark:text-gray-300",children:["Showing ",e.jsx("span",{className:"font-medium",children:(a.currentPage-1)*a.perPage+1})," to ",e.jsx("span",{className:"font-medium",children:Math.min(a.currentPage*a.perPage,a.total)})," of ",e.jsx("span",{className:"font-medium",children:a.total})," results"]})}),e.jsxs("div",{className:"flex space-x-1",children:[e.jsx(n,{variant:"outline",size:"sm",onClick:()=>v(a.currentPage-1),disabled:a.currentPage===1,children:"Previous"}),Array.from({length:a.lastPage},(s,r)=>r+1).filter(s=>{const r=a.currentPage;return s===1||s===a.lastPage||s>=r-1&&s<=r+1}).map((s,r,d)=>r>0&&s-d[r-1]>1?e.jsxs(X.Fragment,{children:[e.jsx(n,{variant:"outline",size:"sm",disabled:!0,children:"..."}),e.jsx(n,{variant:a.currentPage===s?"primary":"outline",size:"sm",onClick:()=>v(s),children:s})]},`ellipsis-${s}`):e.jsx(n,{variant:a.currentPage===s?"primary":"outline",size:"sm",onClick:()=>v(s),children:s},s)),e.jsx(n,{variant:"outline",size:"sm",onClick:()=>v(a.currentPage+1),disabled:a.currentPage===a.lastPage,children:"Next"})]})]})]})]})]}),e.jsx(E,{isOpen:P,onClose:()=>t(!1),onSuccess:S}),e.jsx(E,{isOpen:i,onClose:()=>{y(!1),C(null)},onSuccess:S,user:F})]})}export{We as default};
